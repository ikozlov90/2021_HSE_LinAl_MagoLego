\documentclass[9pt]{beamer}




\usepackage{beamerthemesplit}
\usetheme{Boadilla}
\usecolortheme{orchid}





 % \usepackage[cp866]{inputenc}                %%% Є®¤Ёа®ўЄ  DOS
  \usepackage[cp1251]{inputenc}
%  \usepackage[T2A]{fontenc}                %%% ???
%\usepackage[english,russian]{babel}
%\usepackage[russian]{babel}
 \usepackage[OT1]{fontenc}
%\usepackage[english]{babel}
\usepackage[russian]{babel}

\usepackage{amssymb,latexsym, amsmath, mathdots}

\usepackage{amscd}
\usepackage{multirow}
\usepackage{comment}

\usepackage{epstopdf}



%\usepackage[table]{xcolor} %colored cells

%\usepackage{tikz}
%\usetikzlibrary{tikzmark} %arrows in tables


\usepackage{mnsymbol} % udots in matrices


 \usepackage{pgfpages}
%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=bottom}
%% \setbeameroption{show notes on second screen}

%\setbeamercolor{alerted text}{fg=red!80!black}


% \setbeamercolor{alerted text}{fg=blue!50!green}
% \setbeamercolor{fortheorem}{bg=blue!15!white}
% \setbeamercolor{EMPF}{bg=blue!25!white}
% \setbeamercolor{EMPF2}{bg=blue!35!white}

%\setbeamersize{text margin left=5.mm, text margin right=5.mm}


%---------------------------------------------------------------------------------------------------------------------------

%\def\emphbox#1#2#3{\begin{beamercolorbox}[wd=#2, ht=#1, center, colsep=1.mm]{EMPF} #3 \end{beamercolorbox}}

%---------------------------------------------------------------------------------------------------------------------------


%\advance\leftskip-5.mm



%***************************************************************************************************************************

\theoremstyle{theorem}
\newtheorem{mytheorem}[theorem]{Теорема}
\newtheorem{mylemma}[theorem]{Лемма}
\newtheorem{mycorollary}[theorem]{Следствие}

\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{assertion}[theorem]{Утверждение}
\newtheorem{remark}[theorem]{Замечание}
\newtheorem{assumption}[theorem]{Предположение}

\newtheorem{convention}[theorem]{Договорённость}
\newtheorem{question}[theorem]{Вопрос}
%\newtheorem{mydefinition}{mydefinition}

\theoremstyle{definition}
\newtheorem{mydefinition}[theorem]{Определение}
\newtheorem{myexample}[theorem]{Пример}



%***************************************************************************************************************************

\chardef\No=194
\newcommand{\bd}{{\rm bd}}
\newcommand{\cl}{{\rm cl}}
\newcommand{\ind}{{\rm ind}}
\newcommand{\id}{{\rm id}}
\newcommand{\inj}{{\sl in}}
\newcommand{\pr}{{\rm pr}}
\newcommand{\st}{{\rm St}}


\DeclareMathOperator{\sgrad}{sgrad}

\DeclareMathOperator{\cnt}{const}

\DeclareMathOperator{\Aut}{Aut}


\DeclareMathOperator{\sgn}{sgn}

\DeclareMathOperator{\Int}{Int}


\DeclareMathOperator{\tr}{tr}

\DeclareMathOperator{\Mat}{Mat}







%****************************************************************************
\newcommand{\Ker}{\mathrm{Ker}\,\,}
\newcommand{\Ann}{\mathrm{Ann}\,\,}

\newcommand{\Imm}{\mathrm{Im}\,\,}

\newcommand{\rk}{\mathrm{rk}\,\,}

\newcommand{\const}{\mathrm{const}}



\DeclareMathOperator{\Pen}{\mathcal{P}}


\DeclareMathOperator{\Core}{K}


\DeclareMathOperator{\BLG}{\operatorname{BLG}}

\DeclareMathOperator{\AutBP}{\operatorname{Aut}(V, \mathcal{P})}


\def\minus{\hbox{-}}   %Sign of minus in big matrices

\usepackage{multirow}  %Columns spanning multiple rows

\usepackage[normalem]{ulem} %underline that can break lines

%****************************************************************************



\title% [] (optional, only for long titles)
{МАГОЛЕГО\\ Линейная алгебра в приложениях \\ Семинар 3}
%\subtitle{}
\author [Д.\,И.~Пионтковский, И. \,К.~Козлов] %(optional, for multiple authors)
{Д.\,И.~Пионтковский, И. \,К.~Козлов \\ {\footnotesize(\textit{ВШЭ})}}


\date % [](optional)
{5 февраля 2021}
%\subject{Mathematics}








\usepackage{hyperref}
\hypersetup{unicode=true}



\begin{document}

%\includeonlyframes{}
\frame{\titlepage}




\section{Теория. Лекция.}



\section{Решение Задач к Семинару 2.}






\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2} \tableofcontents[currentsection]\end{frame}




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------




Для любого ЛСУ \[Ax = b\] существует {\color{blue} псевдорешение} \[A^{+}b.\] Это

\vspace{5mm}

\begin{enumerate}

\item решение методом наименьших квадратов \[\left\|A x -  b\right\| \to \min, \] 

\vspace{5mm}

\item наименьшей длины \[ \left\|x\right\| \to \min.  \] 

\end{enumerate}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\textbf{Задача} Найти решение наименьшей длины системы линейных уравнений
\[\begin{cases} x - 3y + t = -1, \\ 2y -3z = -1, \\ x - 2y + z + t = 0,\\ x - 2z + t = 8.\end{cases} \] 



\begin{enumerate}

\item Находим псевдообратную матрицу:


\[\left( \begin{matrix}  1 & -3 & 0 & 1 \\ 0  & 2 & -3 & 0 \\ 1 & -2 & 1 & 1  \\ 1 & 0 & -2 & 1 \end{matrix} \right)^+ =\left( \begin{matrix} -2/5 & -1/10 & 1/2 & 2/5 \\ -3/5 & -1/15 & 1/3 & 4/15 \\ -2/5 & -4/15 & 1/3 & 1/15 \\ -2/5 & -1/10 & 1/2 & 2/5 \end{matrix} \right). \] 


\item Вычисляем ответ: \[ \left( \begin{matrix} -2/5 & -1/10 & 1/2 & 2/5 \\ -3/5 & -1/15 & 1/3 & 4/15 \\ -2/5 & -4/15 & 1/3 & 1/15 \\ -2/5 & -1/10 & 1/2 & 2/5 \end{matrix} \right)  \left( \begin{matrix} -1 \\ -1 \\ 0 \\ 8  \end{matrix} \right) = \left( \begin{matrix} 37/10 \\ 14/5 \\ 6/5 \\ 37/10  \end{matrix} \right). \] 


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------


Алгоритм нахождения SVD-разложения \[ A = U \Sigma V^*.\]


\begin{enumerate}


\item Находим собственные значения $\lambda_i$ матрицы $A^* A$. Сингулярные значения \[\sigma_i =\sqrt{\lambda_i}.\] Так мы нашли  $\Sigma = \operatorname{diag}\left(\sigma_1, \dots,  \sigma_r, 0, \dots, 0\right).$


\vspace{5mm}

\item Находим канонический базис $v_i$ матрицы $A^* A$: \[ (A^* A - \lambda_i E)v_i = 0.\] Канонический базис нужно взять ортонормированным. Это столбцы $V$. 



\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ A v_i = \sigma_i u_i.\]

Если $\sigma_i =0$, то берём векторы единичной длины, ортогональные остальным $u_i$. 


\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\textbf{Задача}. Найти SVD для матрицы  \[ A  = \left( \begin{matrix} 4 & -3i \\ -3i & 4\end{matrix} \right). \] 

\textbf{Ответ:} \[ \left( \begin{matrix} \frac{4}{5} & -\frac{3i}{5} \\ -\frac{3i}{5} & \frac{4}{5} \end{matrix} \right) \left( \begin{matrix} 5 & 0 \\ 0 & 5 \end{matrix} \right) = \left( \begin{matrix} 5 & 0 \\ 0 & 5 \end{matrix} \right) \left( \begin{matrix} \frac{4}{5} & -\frac{3i}{5} \\ -\frac{3i}{5} & \frac{4}{5} \end{matrix} \right). \] 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{alertblock}{Замечание} SVD не всегда однозначно. В разложении \[ M = U \Sigma V^*\]

\vspace{5mm}

\begin{enumerate}

\item сингулярные значения (в матрице $\Sigma$) определены однозначно,

\vspace{5mm}

\item а матрицы $U$ и $V$ не всегда однозначны.

\end{enumerate}


\end{alertblock}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\textbf{Задача}. Найти SVD для матрицы \[ A  = \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right). \]


\begin{enumerate}

\item Находим $A^TA$: \[ A^TA = \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right)^T \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right) = \left( \begin{matrix} 80 & 56 & 16 \\ 56 & 68 & 40 \\ 16 & 40 & 32 \end{matrix} \right). \]

\end{enumerate}

Отметим, что $\operatorname{rk} A = 2$, поэтому $\det A^T A = 0$. 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{enumerate}

\item Находим собственные значения $A^TA$: \[ \det (A^TA - \lambda_i E) = 0.\] В данном случае \[ \det \left(\left( \begin{matrix} 80 & 56 & 16 \\ 56 & 68 & 40 \\ 16 & 40 & 32 \end{matrix} \right)- \lambda E \right) = - \lambda^3 + 180 \lambda^2  -5184 \lambda = -\lambda \left(\lambda - 144 \right) \left( \lambda - 36 \right).\]

Итак, сингулярные значения: \[ \sigma_1 = \sqrt{144} =12, \qquad  \sigma_2 = \sqrt{36} = 6, \qquad \sigma_3 = 0.\] 



\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------
\begin{enumerate}

\item Находим собственные векторы \[ (A^TA - \lambda_i E) v_i= 0.\]



Собственное значение $\lambda_1 = 144$:

\[ A^TA - 144 E =  \left( \begin{matrix} -64 & 56 & 16 \\ 56 & -76 & 40 \\ 16 & 40 & -112 \end{matrix} \right). \]



Решение единичной длины: \[ \displaystyle \left( \begin{matrix} \frac{2}{3} \\[6pt]  \frac{2}{3} \\[6pt] \frac{1}{3} \end{matrix}  \right) \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------
\begin{enumerate}

\item Находим собственные векторы \[ (A^TA - \lambda_i E) v_i= 0.\]




Собственное значение $\lambda_2 = 36$:

\[ A^TA - 36 E =  \left( \begin{matrix} 44 & 56 & 16 \\ 56 & 32 & 40 \\ 16 & 40 & -4 \end{matrix} \right). \]



Решение единичной длины:  \[ \displaystyle \left( \begin{matrix}- \frac{2}{3} \\[6pt]  \frac{1}{3} \\[6pt] \frac{2}{3} \end{matrix}  \right) \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{enumerate}

\item Находим собственные векторы \[ (A^TA - \lambda_i E) v_i= 0.\]




Собственное значение $\lambda_3 = 0$:

\[ A^T A =  \left( \begin{matrix} 80 & 56 & 16 \\ 56 & 68 & 40 \\ 16 & 40 & 32 \end{matrix} \right). \]



Решение единичной длины: \[ \displaystyle \left( \begin{matrix}\frac{1}{3} \\[6pt]  -\frac{2}{3} \\[6pt] \frac{2}{3} \end{matrix}  \right) \]



\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{enumerate}


\item Итак, на данный момент \[  \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right) = U \left( \begin{matrix} 12 & 0  & 0 \\ 0 &6 & 0  \\ 0 & 0 & 0 \\ 0 & 0 & 0  \end{matrix} \right)  \left(\begin{matrix} \frac{2}{3}  & -\frac{2}{3} & \frac{1}{3} \\[6pt] 
\frac{2}{3} & \frac{1}{3} & -\frac{2}{3} \\[6pt] \frac{1}{3} & \frac{2}{3} & \frac{2}{3} \end{matrix} \right)^T.\]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{enumerate}

\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ u_i = \frac{1}{\sigma_i} A v_i.\]


Для $\sigma_1 = 12$: \[ \displaystyle u_1 = \frac{1}{12} \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right) \left( \begin{matrix} \frac{2}{3} \\[6pt]  \frac{2}{3} \\[6pt] \frac{1}{3} \end{matrix}  \right)  = \frac{1}{12} \left( \begin{matrix}  6 \\  6  \\  6  \\ -  6  \end{matrix} \right).  \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

\begin{enumerate}

\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ u_i = \frac{1}{\sigma_i} A v_i.\]


Для $\sigma_2 = 6$: \[ \displaystyle  u_2 = \frac{1}{6}  \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right) \left( \begin{matrix}- \frac{2}{3} \\[6pt]  \frac{1}{3} \\[6pt] \frac{2}{3} \end{matrix}  \right) = \frac{1}{6 } \left( \begin{matrix} -3   \\ -3 \\ 3 \\ -3  \end{matrix} \right).  \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------


\begin{enumerate}

\vspace{5mm}

\item Итак, матрица $U$ имеет вид \[\left(\begin{matrix}
\frac{1}{2} & -\frac{1}{2} & * & * \\[6pt] \frac{1}{2} & -\frac{1}{2} & * & *  \\[6pt] \frac{1}{2} & \frac{1}{2} &* & * \\[6pt] - \frac{1}{2} & -\frac{1}{2} &* & * \end{matrix}  \right) \] Оставшиеся столбцы берём так, чтобы $U$ была ортогональной.

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------


Какой вектор ортогонален векторам $\left(\begin{matrix}
\frac{1}{2}\\[6pt] \frac{1}{2}  \\[6pt] \frac{1}{2} \\[6pt] - \frac{1}{2}  \end{matrix}  \right) , \left(\begin{matrix}
 -\frac{1}{2} \\[6pt] -\frac{1}{2}  \\[6pt] \frac{1}{2}  \\[6pt]  -\frac{1}{2}\end{matrix}  \right) $?
 
 
 \vspace{5mm}
 
 Домножим векторы на константы.
 
 \[\left( \begin{matrix} 1 & 1 &1 & -1\end{matrix}  \right), \quad
 \left( \begin{matrix}- 1 &  -1& 1& -1 \end{matrix}  \right).\]
 
 %----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

 
 Уравнение на ортогональные векторы: \[\begin{cases} x + y + z -t =0 \\ -x -y+z -t=0 \end{cases}\] Пара решений: \[ \left( \begin{matrix} 0 & 0 & 1 & 1\end{matrix}  \right), \quad
 \left( \begin{matrix} -1 &  1& 0& 0 \end{matrix}  \right). \] 
 
 Далее делаем ортогонализацию Грама-Шмидта для этих решений и нормируем их.
 
 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

Получаем ответ:\[  \left( \begin{matrix} 6 & 3 & 0  \\ 6 & 3 & 0  \\ 2 & 5 & 4 \\ -2 & -5 & -4  \end{matrix} \right) = \left(\begin{matrix}
\frac{1}{2} & -\frac{1}{2} & 0 & -\frac{1}{\sqrt{2}} \\[6pt] \frac{1}{2} & -\frac{1}{2} & 0 & \frac{1}{\sqrt{2}}  \\[6pt] \frac{1}{2} & \frac{1}{2} & \frac{1}{\sqrt{2}} & 0 \\[6pt] - \frac{1}{2} & -\frac{1}{2} & \frac{1}{\sqrt{2}} & 0 \end{matrix}  \right) \left( \begin{matrix} 12 & 0  & 0 \\[6pt] 0 &6 & 0  \\ 0 & 0 & 0 \\ 0 & 0 & 0  \end{matrix} \right)  \left(\begin{matrix} \frac{2}{3}  & -\frac{2}{3} & \frac{1}{3} \\[6pt] 
\frac{2}{3} & \frac{1}{3} & -\frac{2}{3} \\[6pt] \frac{1}{3} & \frac{2}{3} & \frac{2}{3} \end{matrix} \right)^T.\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

Псевдообратная через SVD \[ M = U \Sigma V^*.\] 

Тогда {\color{blue} псевдообратная матрица:} \[ M^{+} = V  \Sigma^{+} U^*,\] где \[  \Sigma^{+} =  \left(\frac{1}{\sigma_1}, \dots, \frac{1}{\sigma_k}, 0, \dots, 0\right).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

Обоснование формулы псевдообратной матрицы через SVD.

\vspace{5mm}

\begin{block}{Задача} Доказать утверждение о псевдообратной от произведения матриц. Если $B = AU$, где $U^* = U^{-1}$ --- унитарная матрица, а $A$ --- произвольная матрица порядка $n$, то \[ B^{+} = U^{+} A^{+} = U^{*} A^+.\] \end{block}

\vspace{5mm}




Нужно использовать определение {\color{blue} псевдообратной матрицы} $A^+$:

\begin{gather*} A A^+ A = A, \\  A^+ A A^+ = A, \\ (AA^+)^* = AA^+ \\ (A^+A)^* = A^+A \end{gather*}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------


\begin{enumerate}


\item Докажем, что \[ B B^{+} B = B.\] Подставляем $B = AU$ и $B^{+} = U^{*} A^{+}$: \[  B B^{+} B = AU U^* A^+  AU = AA^+A U = A U = B.\]



\item Докажем, что \[ B^+ B B^+ = B^+.\] Подставляем $B$ и $B^{+}$: \[  B^+ B B^+ = U^* A AU U^* A^+ = U^*A^+AA^+  = U^* A^+ = B^+.\]

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------



\begin{enumerate}[3]
\item Докажем, что \[(BB^+)^* = BB^+.\] Подставляем $B$ и $B^{+}$: \[ (BB^+)^* = (AU U^* A^+)^* = (AA^+)^* = AA^+ =AU U^* A^+ = B B^+.\]




\item Докажем, что \[(B^+B)^* = B^+B.\] Подставляем $B$ и $B^{+}$: \[ (B^+B)^* = (U^* A^+ AU )^* =U^* (A^+ A)^* U = U^* A^+A U  = B^+ B.\]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------


\textbf{Задача}.  Найти псевдообратную матрицу $A^{+}$, используя  SVD: \[ A  = \left( \begin{matrix} 18 & 18 & 9  \\ 4 & -2 & -4  \\ 8 & -4 & -8 \\ 8 & -4 & -8  \end{matrix} \right). \] 


Находим SVD разложение:
\[ \left( \begin{matrix} 1 & 0 & 0 & 0 \\[6pt]  0 &- \frac{1}{3} & - \frac{2}{\sqrt{5}} &  - \frac{2}{3 \sqrt{5}} \\[6pt]  0 & - \frac{2}{3} & 0 & \frac{\sqrt{5}}{3} \\[6pt] 0 & - \frac{2}{3} & \frac{1}{\sqrt{5}} & - \frac{4}{3 \sqrt{5}} \end{matrix} \right) %
\left( \begin{matrix} 27 & 0 &   0 \\ 0 & 18 & 0 \\ 0 & 0 & 0  \\ 0 & 0 & 0 \end{matrix} \right) 
%
\left( \begin{matrix} \frac{2}{3} & -\frac{2}{3} & \frac{1}{3} \\[6pt] \frac{2}{3} &
   \frac{1}{3} & - \frac{2}{3} \\[6pt] \frac{1}{3} & \frac{2}{3} & \frac{2}{3} \end{matrix} \right) ^T
 \] 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 2}
%----------------------------------------------------------

Псевдообратная:
\[ \left( \begin{matrix} 1 & 0 & 0 & 0 \\[6pt]  0 &- \frac{1}{3} & - \frac{2}{\sqrt{5}} &  - \frac{2}{3 \sqrt{5}} \\[6pt]  0 & - \frac{2}{3} & 0 & \frac{\sqrt{5}}{3} \\[6pt] 0 & - \frac{2}{3} & \frac{1}{\sqrt{5}} & - \frac{4}{3 \sqrt{5}} \end{matrix} \right)
%
\left( \begin{matrix} \frac{1}{27} & 0 &   0 \\ 0 & \frac{1}{18} & 0 \\ 0 & 0 & 0  \\ 0 & 0  & 0 \end{matrix} \right)
%
 \left( \begin{matrix} \frac{2}{3} & -\frac{2}{3} & \frac{1}{3} \\[6pt]   \frac{2}{3} &
   \frac{1}{3} & - \frac{2}{3} \\[6pt] \frac{1}{3} & \frac{2}{3} & \frac{2}{3} \end{matrix} \right) ^T=\] \[ = \frac{1}{162} \left( \begin{matrix} 4 & -4 & 2 \\ -2 & -1 & 2 \\ -4 & -2 & 4 \\ -4 & -2 & 4 \end{matrix} \right). \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------











\section{Семинар 3.}



\begin{frame}[plain]\frametitle{} \tableofcontents[currentsection]\end{frame}



\subsection{Линейная регрессия.}



\begin{frame}[plain]\frametitle{} \tableofcontents[currentsection]\end{frame}




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

{\color{blue} Простейшая линейная регрессия.}

\vspace{5mm}

Пусть даны точки $(x_i, y_i)$, где $i = 1,\dots, N$.  Аппроксимируем решение линейной функцией \[ y_i = k x_i + b\]  



\begin{figure}[h!]
\center{\includegraphics[height=0.5\textheight]{Pic/Seminar3b}}
\caption{Рис. 1} \label{Fig:}
\end{figure}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

На самом деле --- это всего лишь псевдорешение \[ \left( \begin{matrix} x_1 & 1 \\ x_2 & 1 \\ \dots & \dots \\ x_n & 1  \end{matrix} \right) \left(\begin{matrix}  k \\ b\end{matrix}\right) =  \left( \begin{matrix}y_1 \\y_2 \\ \dots \\ y_n  \end{matrix} \right). \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Обычно про линейную регрессию пишут, что:

\begin{enumerate}

\item Решение проходит через \[ (\bar{x}, \bar{y}),\] где \[ \bar{x} = \frac{ x_1 + \dots + x_n }{n}, \qquad \bar{y} = \frac{y_1 + \dots + y_n}{n}.\]

\item Мы минимизируем \[\sum_i \left( y_i - \left( k x_i + b \right) \right)^2.  \] Поэтому решение \[ k ={\frac {\sum _{i}(x_{i}-{\bar {x}})(y_{i}-{\bar {y}})}{\sum _{i}(x_{i}-{\bar {x}})^{2}}} \] \[ b = \bar{y} - k \bar{x}.\]


\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Покажем, что линейная регрессия --- умножение на псевдообратную матрицу (см. выше).

\vspace{5mm}

Отметим, что  \[ k ={\frac {\sum _{i}(x_{i}-{\bar {x}})(y_{i}-{\bar {y}})}{\sum _{i}(x_{i}-{\bar {x}})^{2}}} = {\frac {\sum _{i}(x_{i}y_i)-n {\bar {x}}{\bar {y}}}{(\sum _{i}x_{i})-n{\bar {x}}^{2}}} \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


Псевдорешение:
\begin{gather*} \left(\begin{matrix}  k \\ b\end{matrix}\right) = \left( \begin{matrix} x_1 & 1 \\ x_2 & 1 \\ \dots & \dots \\ x_n & 1  \end{matrix} \right)^+  \left( \begin{matrix}y_1 \\y_2 \\ \dots \\ y_n  \end{matrix} \right) =\left( \begin{matrix} \sum x_i^2& n \bar{x} \\ n \bar{x} &n  \end{matrix}  \right)^{-1} \left( \begin{matrix} x_1 & x_2 &\dots & x_n \\ 1 & 1 & \dots & 1 \end{matrix} \right)  \left( \begin{matrix}y_1 \\y_2 \\ \dots \\ y_n  \end{matrix} \right) =\\ = 
\frac{1}{n  (\sum x_i^2)-n^2\bar{x}^2} \left( \begin{matrix} n & -n \bar{x} \\ -n \bar{x} & \sum x_i^2 \end{matrix}  \right)\left( \begin{matrix} \sum x_i y_i \\ n \bar{y} \end{matrix} \right) \end{gather*}




Получаем требуемое: \[ k = {\frac {\sum _{i}(x_{i}y_i)-n {\bar {x}}{\bar {y}}}{(\sum _{i}x_{i})-n{\bar {x}}^{2}}} \]




 Также несложно проверить, что \[ b = \bar{y} - k \bar{x}.\] Действительно, \begin{gather*}  \bar{y} - k \bar{x} = \bar{y}  \frac {(\sum _{i}x_{i}^2)-n{\bar {x}}^{2}}{(\sum _{i}x_{i}^2)-n{\bar {x}}^{2}}   -  {\frac {\sum _{i}(x_{i}y_i)-n {\bar {x}}{\bar {y}}}{(\sum _{i}x_{i}^2)-n{\bar {x}}^{2}}}\bar{x} =  \\ =  \frac{ - \bar{x} \sum _{i}(x_{i}y_i) +  {\bar {y}}(\sum _{i}x_{i}^2)}{(\sum _{i}x_{i}^2)-n{\bar {x}}^{2}}  \end{gather*}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




\subsection{Интерполяционные многочлены Лагранжа и Эрмита}






\begin{frame}[plain]\frametitle{Интерполяционные многочлены Лагранжа и Эрмита} \tableofcontents[currentsubsection]\end{frame}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

{\color{blue} Интерполяционный многочлен Лагранжа}.


\vspace{5mm}

\begin{block}{} Для любого набора чисел \[ (x_0, y_0), \qquad (x_1, y_1), \qquad \dots \qquad (x_n, y_n), \] где все $x_j$ различны, существует единственный многочлен $L(x)$ т.,ч. \begin{enumerate}

\vspace{5mm}

\item $\deg L(x) \leq n$, 

\vspace{5mm}

\item $L(x_j) = y_j$.


\end{enumerate}


\end{block}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Многочлен степени $\leq n$: \[f(x) = a_0 + a_1 x + \dots + a_n x^n. \] Уравнения на интерполяционный многочлен: \[ \begin{cases}  a_0 + a_1 x_0 + \dots + a_n x_0^n = y_0 \\ \cdots \\   a_0 + a_1 x_n + \dots + a_n x_n^n = y_n \end{cases}  \]



 Это система линейных уравнений: \[ \left(\begin{matrix}1&x_{0}&x_{0}^{2}&\dots &x_{0}^{n}\\1&x_{1}&x_{1}^{2}&\dots &x_{1}^{n}\\1&x_{2}&x_{2}^{2}&\dots &x_{2}^{n}\\\vdots &\vdots &\vdots &\ddots &\vdots \\1&x_{n}&x_{n}^{2}&\dots &x_{n}^{n}\end{matrix}\right) \left( \begin{matrix} a_0 \\ a_1 \\ a_2 \\ \vdots \\ a_n   \end{matrix} \right)  = \left( \begin{matrix} y_0 \\ y_1 \\ y_2 \\ \vdots \\ y_n   \end{matrix} \right). \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Интерполяционный многочлен Лагранжа. Вычисление:

\[\displaystyle L(x)=\sum _{i=0}^{n}y_{i}l_{i}(x)\]
где базисные полиномы $l_i(x)$ определяются по формуле: \[\displaystyle l_{i}(x)=\prod _{j=0,j\neq i}^{n}{\frac {x-x_{j}}{x_{i}-x_{j}}}\] Иными словами, \[\displaystyle l_{i}(x)=  {\frac {x-x_{0}}{x_{i}-x_{0}}}\cdots {\frac {x-x_{i-1}}{x_{i}-x_{i-1}}}\cdot {\frac {x-x_{i+1}}{x_{i}-x_{i+1}}}\cdots {\frac {x-x_{n}}{x_{i}-x_{n}}}\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Отметим, что это отношение определителей Вандермонта: \[
v(x_1, \dots, x_n) = \left(\begin{matrix}1&x_{0}&x_{0}^{2}&\dots &x_{0}^{n}\\1&x_{1}&x_{1}^{2}&\dots &x_{1}^{n}\\1&x_{2}&x_{2}^{2}&\dots &x_{2}^{n}\\\vdots &\vdots &\vdots &\ddots &\vdots \\1&x_{n}&x_{n}^{2}&\dots &x_{n}^{n}\end{matrix}\right) =  \prod _{0\leq i<j\leq n}(x_{j}-x_{i}).\]

\vspace{5mm}

Базисные многочлены для интерполяционного многочлена Лагранжа: \[ l_{i}(x) = \frac{v(x_0, \dots, \underset{i}{x} \dots, x_n)}{v(x_0, \dots, x_n)}. \] 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------



\textbf{Задача} Известно, что $f(x)$ --- многочлен третий степени такой, что \[ \begin{cases} f(1) = 2 \\ f(-1) = -3 \\ f(2) = 17 \\ f(-2) = -19.\end{cases} \] Найти $f(x)$. 

\vspace{3mm}

\textbf{Решение} Использовать формулу для интерполяционного многочлена Лагранжа.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


\textbf{Задача}. Приблизить следующую функцию $y(x)$ многочленом второй степени по методу наименьших квадратов  \[ \begin{array}{c|c|c|c|c|c} x & -3 & -1 & 0 & 1 & 3\\\hline  y& -4 & -0.8 & 1.6 & 2.3 & 1.5\end{array}.\]  


 

\vspace{5mm}

\textbf{Решение} Многочлен второй степени: \[ a x^2 + bx + c. \] Ищем решение методом наименьших квадратов \[ \begin{cases} 9 a -3 b + c = -4 \\ 
%
 a - b + c = -0.8 \\ 
%
c = 1.6 \\ 
%
a + b + c = 2.3 \\ 
%
9 a + 3 b + c = 1.5 \\ 
\end{cases}  \] 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

СЛУ:
\[ \left(\begin{matrix} 9 & -3 & 1 \\ 1 & -1 & 1 \\ 0 & 0 & 1 \\ 1 & 1 & 1 \\ 9 & 3 & 1 \end{matrix} \right) \left(\begin{matrix}a \\ b \\ c \end{matrix} \right) =\left(\begin{matrix}  -4 \\ -0.8 \\ 1.6\\ 2.3 \\ 1.5 \end{matrix} \right)  \] 
Находим псевдообратную матрицу:\[ \left(\begin{matrix} 9 & -3 & 1 \\ 1 & -1 & 1 \\ 0 & 0 & 1 \\ 1 & 1 & 1 \\ 9 & 3 & 1 \end{matrix} \right)^+ =   \left(\begin{matrix}  \frac{5}{84} & -\frac{1}{28} & -\frac{1}{21} & -\frac{1}{28} & \frac{5}{84} \\[6pt] -\frac{3}{20} & -\frac{1}{20} & 0& \frac{1}{20} & \frac{3}{20} \\[6pt] -\frac{4}{105} & \frac{12}{35} & \frac{41}{105} & \frac{12}{35} & -\frac{4}{105} \end{matrix} \right) \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Получаем ответ:

 \[\left(\begin{matrix}  \frac{5}{84} & -\frac{1}{28} & -\frac{1}{21} & -\frac{1}{28} & \frac{5}{84} \\[6pt] -\frac{3}{20} & -\frac{1}{20} & 0& \frac{1}{20} & \frac{3}{20} \\[6pt] -\frac{4}{105} & \frac{12}{35} & \frac{41}{105} & \frac{12}{35} & -\frac{4}{105} \end{matrix} \right) \left(\begin{matrix}  -4 \\ -0.8 \\ 1.6\\ 2.3 \\ 1.5 \end{matrix} \right)  =  \left(\begin{matrix}   - \frac{39}{140} \\[6pt] \frac{49}{50} \\[6pt] \frac{216}{175} \end{matrix} \right). \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------








%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


{\color{blue} Эрмитова интерполяция}. Многочлен, который в заданных точках совпадает с значениями исходной функции и её первых $m$ производных.


\vspace{5mm}

\[ {\begin{matrix}(x_{0},y_{0}),&(x_{1},y_{1}),&\ldots ,&(x_{{n-1}},y_{{n-1}}),\\(x_{0},y_{0}'),&(x_{1},y_{1}'),&\ldots ,&(x_{{n-1}},y_{{n-1}}'),\\\vdots &\vdots &&\vdots \\(x_{0},y_{0}^{{(m)}}),&(x_{1},y_{1}^{{(m)}}),&\ldots ,&(x_{{n-1}},y_{{n-1}}^{{(m)}})\end{matrix}}\]

\vspace{5mm}

\begin{block}{} Такой многочлен степени не более $n(m+1)-1$ существует и единственен. \end{block}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------



\textbf{Задача} Найти многочлен $f(x)$ наименьшей степени, удовлетворяющий условиям: \[ \begin{cases} f(x_0) = y_0 \\ f'(x_0) = y_0' \\ f(x_1) = 0 \\ f'(x_1) = x_1'.\end{cases} \]  



\vspace{3mm}

\textbf{Решение}  Ищем многочлен \[ f(x) = a + a_1 x + a_2 x^2 + a_3 x^3. \] Это система линейных уравнений на $a_i$: \[ \begin{cases}  a_0 + a_1 x_0 + a_2 x_0^2 + a_3 x_0^3 = y_0  \\    a_1 + 2 a_2 x_0^2 + 3 a_3 x^2 = y_0'  \\  a_0 + a_1 x_1 + a_2 x_1^2 + a_3 x_1^3 = y_1  \\  a_1 + 2 a_2 x_0^2 + 3 a_3 x^2  = y_1'   \end{cases} \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\subsection{Сплайны}






\begin{frame}[plain]\frametitle{Сплайны} \tableofcontents[currentsubsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

{\color{blue} Сплайн} $S(x)$ --- локально аппроксимируем $f(x)$ полиномом и гладко их сшиваем.

\vspace{5mm}

Пример: Сплайн степени $2$ --- производная $S'(x)$ непрерывна.


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

{Квадратичный сплайн}. Опорные точки: \[ \left[\left({x}_{0},{y}_{0}\right),\left({x}_{1},{y}_{1}\right),....,\left({x}_{n},{y}_{n}\right)\right], \] где \[x_0 < x_1 < \dots < x_n. \]

\begin{itemize} 

\item На каждом отрезке $[x_{i-1},x_i]$ ищем полином \[ S_i(x) = a_i x^2 + b_i x + c_i.\] 



\end{itemize}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------



\begin{itemize} 

\item Условие в узлах: \[ S_i(x_i) = y_i.\]

\vspace{5mm}

\item Непрерывность производной $S'(x)$: \[S_i'(x_i) = S_{i+1}'(x_i) \] 

Граничные условия: \[S_i'(x_0) = d_0. \] Берём $d_0 = f'(x_0)$ или $d_0 = 0$ (если не знаем производную).

\end{itemize}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


%\textbf{Задача}. Аппроксимировать следующую функцию $y(x)$ квадратичным слайном \[ \begin{array}{c|c|c|c|c|c} x & 3 & 4.5 & 7.0 & 9.0 \\\hline  y& 2.5 & 1.0 & 2.5 & 0.5\end{array}\]   и найти приближённое значение $y(x)$ при $x=5$.

\textbf{Задача} Рассмотрим функцию \[ f(x) = (x-1) (x-2)(x-3).\] Аппроксимировать квадратичным сплайном с узлами \[ x_0 = 0, \qquad x_1 = 2, \qquad x_2 = 4.\]

В данном случае \[ f(0) = -6, \qquad f(2) = 0, \qquad f'(0) = 11.\] 

Мы ищем функцию \begin{gather*}  f_1(x)=a_2x^2+a_1x+a_0, \qquad  0 \leq x \leq 2, \\ f_2(x)=b_2x^2+b_1x+b_0, \qquad  2 \leq x \leq 4.
 \end{gather*}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Уравнения на первую функцию: \[ \begin{cases} f_1(0) = f(0), \\ f'_1(0) = f'(0), \\ f_1(2) = f(2). \end{cases}  \]  Получаем \[ \begin{cases} a_0  = -6, \\ a_1 = 11, \\ 4 a_2  + 11 * 2 - 6 = 0. \end{cases}  \]  Итак, \[f_1(x) = - 4 x^2 + 11x - 6.  \]

Отметим, что \[ f'_1(2) = -8 *2 + 11 = -5.\] 




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------






%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Уравнения на вторую функцию: \[ \begin{cases} f_2(2) = f(2), \\ f'_2(2) = f'_1(2), \\ f_2(4) = f(4). \end{cases}  \]  Получаем \[ \begin{cases} 4 b_2  + 2 b_1 + b_0	 = 0, \\ 4b_2 + b_1 = -5, \\ 16 b_2  + 4b_1 	+ b_0  = 6. \end{cases}  \]  Итак, \[f_2(x) =  4 x^2 - 21x + 26.  \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


Итоговый квадратичный сплайн:

\begin{gather*}  f_1(x) = - 4 x^2 + 11x - 6, \qquad  0 \leq x \leq 2, \\ f_2(x) =  4 x^2 - 21x + 26, \qquad  2 \leq x \leq 4.
 \end{gather*}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




\subsection{Кривые Безье}






\begin{frame}[plain]\frametitle{Кривые Безье} \tableofcontents[currentsubsection]\end{frame}







%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

{\color{blue} Кривые Безье}. ${\displaystyle \mathbf {B} _{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n}}}$ --- кривая Безье с опорными точками $P_0, P_1, \dots, P_n$.


\vspace{5mm}

\textbf{Рекурсивное определение.}  Кривая степени ноль --- это точка: \[  \mathbf {B} _{\mathbf {P} _{0}}(t)=\mathbf {P} _{0} \] \textit{Кривая Безье степени $n$ --- линейная комбинация кривых Безье степени $n-1$.} \[
{\displaystyle \mathbf {B} (t)=\mathbf {B} _{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n}}(t)=(1-t)\mathbf {B} _{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n-1}}(t)+t\mathbf {B} _{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(t)}\] 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

\begin{figure}[h!]
\center{\includegraphics[height=\textheight]{Pic/Seminar3a}}
\caption{Рис. 1} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

\textbf{Задача}. Доказать, что кривая Безье касается первого и последнего отрезка ломаной. 





\vspace{5mm}

Нужно доказать:

\vspace{5mm}

\begin{itemize}

\item Касание первого отрезка ломаной в точке $P_0$: \[ \frac{d}{dt}\biggr|_{t=0} B_{P_0 P_1 \dots P_n} = \alpha_n (P_1 - P_0) \] 

\item Касание последнего отрезка ломаной в точке $P_n$:  \[ \frac{d}{dt}\biggr|_{t=1} B_{P_0 P_1 \dots P_n} = \beta_n (P_{n} - P_{n-1}) \]

\end{itemize}

для некоторых констант $\alpha_k, \beta_k$. 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Докажем касание первого отрезка ломаной (касание последнего отрезка доказывается аналогично).

\vspace{5mm}

Доказательство по индукции:




\vspace{5mm}

\begin{itemize}

\item База. $n=1$. \[ B(t) = (1-t)P_0 + t P_1\] Поэтому \[ B'(0) = P_1 - P_0.\]


\end{itemize}





%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

\begin{itemize}


\item Шаг. Пусть при $k < n$. \[\frac{d}{dt}\biggr|_{t=0} \mathbf {B}_{P_0 P_1 \dots P_k} = \alpha_k (P_1 - P_0) .\]
Используем рекурсивное кривых Безье.  \[
\displaystyle \mathbf {B} (t)=\mathbf {B} _{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n}}(t)=(1-t)\mathbf {B} _{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n-1}}(t)+t\mathbf {B} _{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(t)\] 




Тогда \begin{gather*} \frac{d}{dt} \mathbf {B}_{P_0 P_1 \dots P_n} = -\mathbf {B}_{P_0 P_1 \dots P_{n-1}} (t) + (1-t)\mathbf {B}'_{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n-1}}(t)+ \\ + \mathbf {B} _{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(t)+ t\mathbf {B}'_{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(t) \end{gather*} 


\end{itemize}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------



\begin{itemize}


\item Кривая Безье проходит через опорные точки, поэтому: \[ \mathbf {B}_{P_0 P_1 \dots P_{n-1}} (0)  = P_0, \qquad \mathbf {B} _{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(0) = P_1\]

\vspace{5mm}

\item  По предположению индукции:

\[\mathbf {B}'_{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n-1}}(t)= \alpha_{n-1} (P_1 - P_0) \]




\item Подставляем:

 \begin{gather*} \frac{d}{dt}\biggr|_{t=0} \mathbf {B}_{P_0 P_1 \dots P_n} = -\mathbf {B}_{P_0 P_1 \dots P_{n-1}} (0)  - \mathbf {B}'_{\mathbf {P} _{0}\mathbf {P} _{1}\ldots \mathbf {P} _{n-1}}(0) + \mathbf {B} _{\mathbf {P} _{1}\mathbf {P} _{2}\ldots \mathbf {P} _{n}}(0) = \\ =-P_0 + P_1 +  \alpha_{n-1} (P_1 - P_0)  = ( \alpha_{n-1} + 1)(P_1 - P_0).   \end{gather*}


\end{itemize}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------
\textbf{Явная формула.}

\[{\displaystyle {\begin{aligned}\mathbf {B} (t)&=\sum _{i=0}^{n}{n \choose i}(1-t)^{n-i}t^{i}\mathbf {P} _{i} = \\&=(1-t)^{n}\mathbf {P} _{0}+{n \choose 1}(1-t)^{n-1}t\mathbf {P} _{1}+\cdots +{n \choose n-1}(1-t)t^{n-1}\mathbf {P} _{n-1}+t^{n}\mathbf {P} _{n}&&\end{aligned}}}\] где $0\leqslant t\leqslant 1$.


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------

Напомним формулу биномиальных коэффициентов: \[{n \choose i}={\frac {n!}{i!(n-i)!}}\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 3}
%----------------------------------------------------------


\textbf{Задача} Построить кривую Безье: \[ P_0(-1, -1), \qquad  P_1(1, 3), \qquad P_2(2, 4), \qquad P_1(7, -1).\]


\vspace{5mm}

\textbf{Решение.} Применить явную формулу.

%\[{\displaystyle {\begin{aligned}\mathbf {B} (t)&=\sum _{i=0}^{n}{n \choose i}(1-t)^{n-i}t^{i}\mathbf {P} _{i} = \\&=(1-t)^{n}\mathbf {P} _{0}+{n \choose 1}(1-t)^{n-1}t\mathbf {P} _{1}+\cdots +{n \choose n-1}(1-t)t^{n-1}\mathbf {P} _{n-1}+t^{n}\mathbf {P} _{n}&&\end{aligned}}}\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

\end{document}
