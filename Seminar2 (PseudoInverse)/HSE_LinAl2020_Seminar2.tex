\documentclass[9pt]{beamer}




\usepackage{beamerthemesplit}
\usetheme{Boadilla}
\usecolortheme{orchid}





 % \usepackage[cp866]{inputenc}                %%% Є®¤Ёа®ўЄ  DOS
  \usepackage[cp1251]{inputenc}
%  \usepackage[T2A]{fontenc}                %%% ???
%\usepackage[english,russian]{babel}
%\usepackage[russian]{babel}
 \usepackage[OT1]{fontenc}
%\usepackage[english]{babel}
\usepackage[russian]{babel}

\usepackage{amssymb,latexsym, amsmath, mathdots}

\usepackage{amscd}
\usepackage{multirow}
\usepackage{comment}

\usepackage{epstopdf}



%\usepackage[table]{xcolor} %colored cells

%\usepackage{tikz}
%\usetikzlibrary{tikzmark} %arrows in tables


\usepackage{mnsymbol} % udots in matrices


 \usepackage{pgfpages}
%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=bottom}
%% \setbeameroption{show notes on second screen}

%\setbeamercolor{alerted text}{fg=red!80!black}


% \setbeamercolor{alerted text}{fg=blue!50!green}
% \setbeamercolor{fortheorem}{bg=blue!15!white}
% \setbeamercolor{EMPF}{bg=blue!25!white}
% \setbeamercolor{EMPF2}{bg=blue!35!white}

%\setbeamersize{text margin left=5.mm, text margin right=5.mm}


%---------------------------------------------------------------------------------------------------------------------------

%\def\emphbox#1#2#3{\begin{beamercolorbox}[wd=#2, ht=#1, center, colsep=1.mm]{EMPF} #3 \end{beamercolorbox}}

%---------------------------------------------------------------------------------------------------------------------------


%\advance\leftskip-5.mm



%***************************************************************************************************************************

\theoremstyle{theorem}
\newtheorem{mytheorem}[theorem]{Теорема}
\newtheorem{mylemma}[theorem]{Лемма}
\newtheorem{mycorollary}[theorem]{Следствие}

\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{assertion}[theorem]{Утверждение}
\newtheorem{remark}[theorem]{Замечание}
\newtheorem{assumption}[theorem]{Предположение}

\newtheorem{convention}[theorem]{Договорённость}
\newtheorem{question}[theorem]{Вопрос}
%\newtheorem{mydefinition}{mydefinition}

\theoremstyle{definition}
\newtheorem{mydefinition}[theorem]{Определение}
\newtheorem{myexample}[theorem]{Пример}



%***************************************************************************************************************************

\chardef\No=194
\newcommand{\bd}{{\rm bd}}
\newcommand{\cl}{{\rm cl}}
\newcommand{\ind}{{\rm ind}}
\newcommand{\id}{{\rm id}}
\newcommand{\inj}{{\sl in}}
\newcommand{\pr}{{\rm pr}}
\newcommand{\st}{{\rm St}}


\DeclareMathOperator{\sgrad}{sgrad}

\DeclareMathOperator{\cnt}{const}

\DeclareMathOperator{\Aut}{Aut}


\DeclareMathOperator{\sgn}{sgn}

\DeclareMathOperator{\Int}{Int}


\DeclareMathOperator{\tr}{tr}

\DeclareMathOperator{\Mat}{Mat}







%****************************************************************************
\newcommand{\Ker}{\mathrm{Ker}\,\,}
\newcommand{\Ann}{\mathrm{Ann}\,\,}

\newcommand{\Imm}{\mathrm{Im}\,\,}

\newcommand{\rk}{\mathrm{rk}\,\,}

\newcommand{\const}{\mathrm{const}}



\DeclareMathOperator{\Pen}{\mathcal{P}}


\DeclareMathOperator{\Core}{K}


\DeclareMathOperator{\BLG}{\operatorname{BLG}}

\DeclareMathOperator{\AutBP}{\operatorname{Aut}(V, \mathcal{P})}


\def\minus{\hbox{-}}   %Sign of minus in big matrices

\usepackage{multirow}  %Columns spanning multiple rows

\usepackage[normalem]{ulem} %underline that can break lines

%****************************************************************************



\title% [] (optional, only for long titles)
{МАГОЛЕГО\\ Линейная алгебра в приложениях \\ Семинар 2}
%\subtitle{}
\author [Д.\,И.~Пионтковский, И. \,К.~Козлов] %(optional, for multiple authors)
{Д.\,И.~Пионтковский, И. \,К.~Козлов \\ {\footnotesize(\textit{ВШЭ})}}


\date % [](optional)
{29 января 2021}
%\subject{Mathematics}








\usepackage{hyperref}
\hypersetup{unicode=true}



\begin{document}

%\includeonlyframes{}
\frame{\titlepage}




\section{Теория. Лекция.}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Теория. Лекция 1}
%----------------------------------------------------------


{\color{blue} Псевдообратная матрица} $A^+$:

\begin{gather*} A A^+ A = A, \\[6pt]  A^+ A A^+ = A, \\[6pt] (AA^+)^* = AA^+ \\[6pt] (A^+A)^* = A^+A \end{gather*}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\section{Решение Задач к Семинару 1.}



\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1} \tableofcontents[currentsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

 Если столбцы $A$ линейно независимы, то \[ A^+ = (A^* A)^{-1} A^*.\]
 
 Поэтому \[ \left( \begin{matrix} a_1 \\ \vdots \\ a_n \end{matrix} \right)^+ = \frac{1}{\left|a_1\right|^2 + \dots \left| a_n^2\right|} \left( \begin{matrix} \bar{a_1} & \dots & \bar{a_n} \end{matrix} \right).  \]





%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

 Если строки $A$ линейно независимы, то \[  A^+ = A^*(A A^*)^{-1}.\]
 
 Поэтому \[ \left( \begin{matrix} a_1 & \dots & a_n \end{matrix} \right)^+ = \frac{1}{\left|a_1\right|^2 + \dots \left| a_n^2\right|} \left( \begin{matrix} \bar{a_1} \\ \vdots \\ \bar{a_n} \end{matrix} \right).  \]





%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\textbf{Решение Задач 1-3:}

\vspace{5mm}

\begin{enumerate}

\item $\left(\begin{matrix} 1 & 0 \end{matrix}\right)^{+} =\left (\begin{matrix} 1 \\ 0\end{matrix}\right).$

\vspace{5mm}

\item $\displaystyle\left(\begin{matrix} 0 \\ 1 \\ 2 \\ 3 \end{matrix}\right)^{+}= \frac{1}{14} \left(\begin{matrix} 0 & 1 & 2 & 3 \end{matrix} \right).$

\vspace{5mm}

\item $\displaystyle \left(\begin{matrix} 3 & 2 & 1 & 0\end{matrix}\right)^{+} = \frac{1}{14} \left(\begin{matrix} 3 \\ 2 \\ 1 \\ 0  \end{matrix}\right).$

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\textbf{Задача 4:} Найти $\displaystyle \left(\begin{matrix} 1 & 0 \\ -1 & 0 \\ -1 & 0 \\ 2 & 1 \end{matrix}\right)^{+}$.

Действительно,  \[A^+ = (A^T A)^{-1}A^T.\]



Матрица \[G = A^T A = \left( \begin{matrix} 7 & 2 \\ 2 & 1\end{matrix}  \right) \] суть матрица Грамма для столбцов \[ \left(\begin{matrix} 1  \\ -1 \\ -1 \\ 2  \end{matrix}\right), \qquad \left(\begin{matrix} 0 \\  0 \\ 0 \\ 1 \end{matrix}\right) \] 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

Таким образом \[(A^T A)^{-1} = \left( \begin{matrix} 7 & 2 \\ 2 & 1\end{matrix}  \right)^{-1} = \frac{1}{3}  \left( \begin{matrix} 1 & -2 \\ -2 & 7\end{matrix}  \right).\] 
Поэтому ответ в задаче: \begin{gather*} \left(\begin{matrix} 1 & 0 \\ -1 & 0 \\ -1 & 0 \\ 2 & 1 \end{matrix}\right)^{+} =  \frac{1}{3}  \left( \begin{matrix} 1 & -2 \\ -2 & 7\end{matrix}  \right)\left(\begin{matrix} 1 & -1 & -1 & 2 \\ 0 & 0 & 0 & 1 \end{matrix}\right) = \\ = \frac{1}{3} \left(\begin{matrix} 1 & -1 & -1 & 0 \\ -2 & 2 & 2 & 3 \end{matrix}\right) . \end{gather*} 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\textbf{Задача 5:} Найти  $\left(\begin{matrix} 1 & 2 & 3 \\ 0 & -1 & -2 \end{matrix}\right)^{+}.$

Действительно,  \[A^+ =A^T (A A^T)^{-1}.\]

  

Матрица \[G = A A^T = \left( \begin{matrix} 14 & -8 \\ -8 & 5\end{matrix}  \right) \] суть матрица Грамма для строк \[ \left(\begin{matrix} 1  & 2 & 3  \end{matrix}\right), \qquad \left(\begin{matrix} 0 & -1 & -2 \end{matrix}\right). \] 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


Таким образом \[( AA^T)^{-1} = \left( \begin{matrix} 14 & -8 \\ -8 & 5\end{matrix}  \right)^{-1} = \frac{1}{6}  \left( \begin{matrix} 5 & 8 \\ 8 & 14\end{matrix}  \right).\] 
Поэтому ответ в задаче: \begin{gather*}\left(\begin{matrix} 1 & 2 & 3 \\ 0 & -1 & -2 \end{matrix}\right)^{+} =  \frac{1}{6} \left(\begin{matrix} 1 & 0 \\ 2 & -1 \\ 3 &  -2 \end{matrix}\right)  \left( \begin{matrix}  5 & 8 \\ 8 & 14 \end{matrix}  \right) = \\ = \frac{1}{6} \left(\begin{matrix}5 & 8 \\ 2 & 2 \\ -1 & -4 \end{matrix}\right) . \end{gather*} 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


Как находить {\color{blue} скелетное разложение} (разложение полного ранга)? \[ A = F G,\] где 

\vspace{5mm}

\begin{enumerate}

\item $A$ --- это $m \times n$ матрица, $\operatorname{rk} A = r$.

\vspace{5mm}

\item $F$ --- это $m \times r$ матрица, 

\vspace{5mm}

\item $G$ --- это $r \times n$ матрица.

\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

ШАГ 1. Пусть $A$ --- матрица {\color{blue} приведённого ступенчатого вида по строкам}.

\vspace{5mm}

$F$ и $G$ легко видны:

\[ \left( \begin{matrix} 1 & a_1 & 0 & b_1  \\  0 & 0 & 1 & b_2   \\ 0 & 0 & 0 & 0  \end{matrix} \right) =  \left( \begin{matrix} 1 & 0 \\ 0 & 1 \\ 0 & 0 \end{matrix} \right) \left( \begin{matrix} 1 & a_1 & 0 & b_1  \\ 0 & 0 & 1 & b_2\end{matrix} \right)  \] 

\vspace{5mm}



``Приведённый'' означает: 

\vspace{3mm}

\begin{itemize} 

\item все ведущие элементы равны $1$, 

\vspace{3mm}

\item под ними и над ними стоят $0$. 

\end{itemize}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

Скелетное разложение для матриц {\color{blue} приведённого ступенчатого вида по строкам}

\vspace{5mm}


\begin{itemize}

\item $F$ составлена из столбцов с ведущими элементами $A$,

\vspace{5mm}

\item $G$ составлена из ненулевых строк $A$.

\end{itemize}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

ШАГ 2. Общий случай.

\vspace{5mm}

Достаточно привести $A$ к  приведённому ступенчатому виду. 


\vspace{5mm}

Ответ строится аналогично.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------




\begin{exampleblock}{Задача 6} Пусть $A$ --- произвольная $m \times n$ матрица. Преобразуем $A$ к приведённому ступенчатому виду по строкам $B$. Пусть  $i_1, \dots, i_r$ --- номера столбцов $B$ с ведущими коэффициентами. Рассмотрим матрицы:


\vspace{5mm}


\begin{itemize}

\item $F$ составлена из столбцов $A$ с номерами $i_1, \dots, i_r$,

\vspace{5mm}

\item $G$ составлена из ненулевых строк $B$.


\end{itemize}

\vspace{5mm}

Доказать, что  \[ A = FG,\] и что это разложение полного ранга (скелетное разложение) матрицы $A$.


\end{exampleblock} 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


Напомним, что любая матрица приводится к своему {\color{blue} каноническому виду} (приведённому ступенчатому виду по строкам) при помощи {\color{blue} элементарных преобразований строк}:

\vspace{5mm}



\begin{enumerate}

\item перестановка двух строк местами \[ R_i \leftrightarrow R_j;\]



\item умножение строки матрицы на ненулевую константу \[ \lambda R_i \rightarrow R_i,\qquad \lambda \neq 0;\]



\item прибавление к одной строке другой строки, умноженной на константу \[R_i + \lambda R_j \rightarrow R_i, \qquad i \neq j .\]

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------



Все элементарные преобразования --- умножения слева на матрицу. 


\vspace{5mm}

\begin{enumerate}

\item Перестановка строки $i$ и $j$ местами: меняем на $A$ на $T_{ij}A$, где \[ {\displaystyle T_{i,j}={\left(\begin{matrix}1&&&&&&\\&\ddots &&&&&\\&&0&&1&&\\&&&\ddots &&&\\&&1&&0&&\\&&&&&\ddots &\\&&&&&&1\end{matrix}\right)}}.\]  

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{enumerate}[2]

\item Умножить  $i$-тую строку на $k$: меняем на $A$ на $D_i(\lambda)A $, где \[ {\displaystyle D_{i}(\lambda)={\left(\begin{matrix}1&&&&&&\\&\ddots &&&&&\\&&1&&&&\\&&&\lambda&&&\\&&&&1&&\\&&&&&\ddots &\\&&&&&&1\end{matrix}\right)}}.\]  

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{enumerate}[3]

\item Прибавить к  $i$-той строке $j$-тую, умноженную на $\lambda$: меняем на $A$ на $L_{ij}(\lambda)A $, где \[{\displaystyle L_{ij}(\lambda)={\left(\begin{matrix}1&&&&&&\\&\ddots &&&&&\\&&1&&&&\\&&&\ddots &&&\\&&\lambda&&1&&\\&&&&&\ddots &\\&&&&&&1\end{matrix}\right)}}.\]  

\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\textbf{Существование скелетного разложения:}

\vspace{3mm}

\begin{itemize}

\item Приведём матрицу $A$ к каноническому виду:  \[ A = P B,\]  где $P$ --- произведение элементарных матриц.

\vspace{3mm}



\item Для канонического вида формула для скелетного разложения уже доказана: \[ B = \hat{F} G,\] где $\hat{F}$ --- столбцы $i_1, \dots, i_r$ матрицы $B$.

\vspace{3mm}



\item Напомним формулу для произведения матриц: \[PB = \left( Pb_1, \dots, Pb_n \right). \] 




\item Поэтому \[ A = FG,\] где $F = P \hat{F}$ --- это  столбцы $i_1, \dots, i_r$ матрицы $A$.

\end{itemize}





%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\textbf{Задача 7.} Найти разложение полного ранга (скелетное разложение) \[\left( \begin{matrix} 1 & 1 & 1 \\ 2 & 2 & 2 \\ 3 & 3 & 3 \\ 1 & 2 & 3\end{matrix} \right). \] 



Приводим к каноническому виду:

 \[ \left( \begin{matrix} 1 & 1 & 1 \\ 2 & 2 & 2 \\ 3 & 3 & 3 \\ 1 & 2 & 3\end{matrix} \right) \sim 
 %
  \left( \begin{matrix} 1 & 1 & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 1 & 2\end{matrix} \right) \sim 
%
 \left( \begin{matrix} 1 & 1 & 1 \\ 0 & 1 & 2 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{matrix} \right) \sim 
 %
 \left( \begin{matrix} 1 & 0 & -1 \\ 0 & 1 & 2 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{matrix} \right)  \]

 

Получаем ответ:

 \[F =\left( \begin{matrix} 1 & 1  \\ 2 & 2  \\ 3 & 3  \\ 1 & 2 \end{matrix} \right), \qquad G =\left( \begin{matrix} 1 & 0 & -1 \\ 0 & 1 & 2  \end{matrix} \right).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


Легко проверить:
\[  \left( \begin{matrix} 1 & 1 & 1 \\ 2 & 2 & 2 \\ 3 & 3 & 3 \\ 1 & 2 & 3\end{matrix} \right) = 
\left( \begin{matrix} 1 & 1  \\ 2 & 2  \\ 3 & 3  \\ 1 & 2 \end{matrix} \right) \left( \begin{matrix} 1 & 0 & -1 \\ 0 & 1 & 2  \end{matrix} \right).\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\textbf{Задача 8.} Вычислите \[\left( \begin{matrix} 1 & 0 & 0 \\ 1 & 1 & 1 \\ 0 & 1 & 1\end{matrix} \right)^{+}. \] 





\begin{enumerate}

\item Находим скелетное разложение. 


 \[\left( \begin{matrix} 1 & 0 & 0 \\ 1 & 1 & 1 \\ 0 & 1 & 1\end{matrix} \right) \sim 
 %
  \left( \begin{matrix} 1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 1 & 1\end{matrix} \right)\sim 
%
 \left( \begin{matrix} 1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 0\end{matrix} \right) \]
 
 
 
 
 Таким образом $A = FG$, где  \[F = \left( \begin{matrix} 1 & 0  \\ 1 & 1  \\ 0 & 1 \end{matrix} \right), \qquad G = \left( \begin{matrix} 1 & 0 & 0 \\ 0 & 1 & 1\end{matrix} \right).\]



\end{enumerate}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------



\begin{enumerate}[2]

\item Находим $F^{+}$, где \[ F = \left( \begin{matrix} 1 & 0  \\ 1 & 1  \\ 0 & 1 \end{matrix} \right).\] 

Так как столбцы линейно независимы, \[ F^+ = (F^* F)^{-1} F^*.\]
 
Далее, \[F^* F =  \left( \begin{matrix} 1 & 1  & 0  \\ 0 & 1 & 1\end{matrix} \right) \left( \begin{matrix} 1 & 0  \\ 1 & 1  \\ 0 & 1 \end{matrix} \right) = \left( \begin{matrix} 2 & 1 \\ 1 & 2 \end{matrix} \right) .  \]

Таким образом, \[ F^+ = (F^* F)^{-1} F^* = \frac{1}{3}  \left( \begin{matrix} 2 & -1 \\ -1 & 2 \end{matrix} \right) \left( \begin{matrix} 1 & 1  & 0  \\ 0 & 1 & 1\end{matrix} \right)  = \frac{1}{3} \left( \begin{matrix} 2 & 1  & -1  \\ -1 & 1 & 2\end{matrix} \right).\]


\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\begin{enumerate}[3]

\item Находим $G^{+}$, где \[ G = \left( \begin{matrix} 1 & 0 & 0 \\ 0 & 1 & 1\end{matrix} \right).\] 

Так как строки линейно независимы,  \[  G^+ = G^*(G G^*)^{-1}.\]
 
Далее, \[ G G^* =  \left( \begin{matrix} 1 & 0 & 0 \\ 0 & 1 & 1\end{matrix} \right) \left( \begin{matrix} 1 & 0 \\ 0 & 1  \\ 0 & 1 \end{matrix} \right) = \left( \begin{matrix} 1 & 0 \\ 0 & 2 \end{matrix} \right) .  \]

Таким образом, \[  G^+ = G^*(G G^*)^{-1} = \frac{1}{2}  \left( \begin{matrix} 2 &0 \\ 0 & 1 \end{matrix} \right) \left( \begin{matrix} 1 & 0 \\ 0 & 1  \\ 0 & 1 \end{matrix} \right)  = \frac{1}{2} \left( \begin{matrix} 2 & 0 \\ 0 & 1  \\ 0 & 1 \end{matrix} \right) .\]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{enumerate}[4]

\item $A = FG$, поэтому \begin{gather*} A^+ = G^+ F^+ =  \frac{1}{2} \left( \begin{matrix} 2 & 0 \\ 0 & 1  \\ 0 & 1 \end{matrix} \right)  \cdot  \frac{1}{3} \left( \begin{matrix} 2 & 1  & -1  \\ -1 & 1 & 2\end{matrix} \right) =  \\ =  \frac{1}{6} \left( \begin{matrix} 4 & 2 & -2 \\ -1 & 1 & 2 \\ -1 & 1 & 2 \end{matrix} \right).\end{gather*} \end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------

\textbf{Задача 9}.
Пусть $E_{ij}$ --- матрица размера $n \times n$ такая, что её элементы в $i$-той строке и $j$-том столбце равны $1$, а все остальные элементы равны $0$.

\begin{figure}[h!]
\center{\includegraphics[width=0.7\linewidth]{Pic/Problem9a}}
\caption{Рис. 1} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{figure}[h!]
\center{\includegraphics[height=\textheight]{Pic/Problem9b}}
\caption{Рис. 2} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{figure}[h!]
\center{\includegraphics[height=\textheight]{Pic/Problem9c}}
\caption{Рис. 3} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Решение Задач к Семинару 1}
%----------------------------------------------------------


\begin{figure}[h!]
\center{\includegraphics[height=\textheight]{Pic/Problem9d}}
\caption{Рис. 4} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------







\section{Семинар 2.}



\begin{frame}[plain]\frametitle{} \tableofcontents[currentsection]\end{frame}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------




Для любого ЛСУ \[Ax = b\] существует {\color{blue} псевдорешение} \[A^{+}b.\] Это

\vspace{5mm}

\begin{enumerate}

\item решение методом наименьших квадратов \[\left\|A x -  b\right\| \to \min, \] 

\vspace{5mm}

\item наименьшей длины \[ \left\|x\right\| \to \min.  \] 

\end{enumerate}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\textbf{Задача} Найти решение системы линейных уравнений наименьшей длины 
\[\begin{cases} 2x + 3y + 2 z = 7, \\ 3x + 4y - z = 6.\end{cases} \] 




\begin{enumerate}

\item Находим псевдообратную матрицу:

\[\left( \begin{matrix}  2 & 3 & 2 \\ 3 & 4 & -1 \end{matrix} \right)^+ = \frac{1}{186}\left( \begin{matrix} 4 & 19 \\ 14 &  20 \\ 68 & -49 \end{matrix} \right). \] 

\item Находим ответ:

\[ \left(\begin{matrix} x \\ y \\ z \end{matrix} \right)  =  \frac{1}{186}\left( \begin{matrix} 4 & 19 \\ 14 &  20 \\ 68 & -49 \end{matrix} \right) \left(\begin{matrix} 7 \\ 6 \end{matrix} \right) = \frac{1}{93} \left(\begin{matrix} 71 \\ 109 \\ 91\end{matrix} \right).\] 

\end{enumerate} 





%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------






%----------------------------------------------------------
\begin{frame}[plain]\frametitle{SVD разложение}
%----------------------------------------------------------

Пусть $A$ --- $m\times n$ матрица над $\mathbb{R}$. {\color{blue} SVD-разложение:}  \[ A = U \Sigma V^T,\] где 

\begin{enumerate}

\item U --- ортогональная $m \times m$ матрица,

\vspace{5mm}


\item V --- ортогональная $n \times n$ матрица,

\vspace{5mm}

\item а $\Sigma$ --- это диагональная матрица: \[ \Sigma = \operatorname{diag} (\sigma_1, \dots, \sigma_k, 0, \dots, 0),\] с неотрицательными собственными значениями на диагонали: \[ \sigma_1 \geq \dots \geq \sigma_k > 0.\]

\end{enumerate}






%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{SVD разложение}
%----------------------------------------------------------

{\color{blue} SVD-разложение} над $\mathbb{C}$ определяется аналогично:   \[ A = U \Sigma V^*,\] но

\begin{enumerate}

\item ортогональные матрицы $U, V$ заменяются на унитарные,

\vspace{5mm}

\item а $V^*$ --- это комплексное сопряжение: \[ V^* = \bar{V}^T,\]

\vspace{5mm}

\item все значения диагональной матрицы $\Sigma$ вещественны и неотрицательны:  \[ \sigma_1 \geq \dots \geq \sigma_k > 0.\]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{SVD разложение}
%----------------------------------------------------------


\begin{mytheorem} Для любой (вещественной или комплексной $n\times m$) матрицы $A$ существует SVD разложение. \end{mytheorem}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------


Алгоритм нахождения SVD-разложения \[ A = U \Sigma V^*.\]


\begin{enumerate}


\item Находим собственные значения $\lambda_i$ матрицы $A^* A$. Сингулярные значения \[\sigma_i =\sqrt{\lambda_i}.\] Так мы нашли  $\Sigma = \operatorname{diag}\left(\sigma_1, \dots,  \sigma_r, 0, \dots, 0\right).$


\vspace{5mm}

\item Находим канонический базис $v_i$ матрицы $A^* A$: \[ (A^* A - \lambda_i E)v_i = 0.\] Канонический базис нужно взять ортонормированным. Это столбцы $V$. 



\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ A v_i = \sigma_i u_i.\]

Если $\sigma_i =0$, то берём векторы единичной длины, ортогональные остальным $u_i$. 


\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\textbf{Задача}. Найти SVD для матрицы \[ A  = \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right). \]



\begin{enumerate}

\item Находим $A^TA$: \[ A^TA =  \left( \begin{matrix} 3 & 2 & 2 \\ 2 & 3 & -2 \end{matrix} \right) \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right) = \left( \begin{matrix} 17 & 8 \\ 8 & 17 \end{matrix} \right). \]


\end{enumerate}
%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\item Находим собственные значения $A^TA$: \[ \det (A^TA - \lambda_i E) = 0.\] В данном случае \[ \det \left( \left( \begin{matrix} 17 & 8 \\ 8 & 17 \end{matrix} \right) - \lambda E \right) = \lambda^2 - 34 \lambda +225 = \left(\lambda - 25 \right) \left( \lambda - 9 \right).\]

Итак, сингулярные значения: \[ \sigma_1 = \sqrt{25} = 5, \qquad  \sigma_2 = \sqrt{9} = 3.\]





\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\item Находим собственные векторы \[ (A^TA - \lambda_i E) v_i= 0.\]



Собственное значение $\lambda_1 = 25$:

\[ A^TA - 25 E =  \left(\begin{matrix} -8 & 8 \\ 8 & -8\end{matrix} \right). \]



Решение единичной длины: \[ \displaystyle \left( \begin{matrix} \frac{1}{\sqrt{2}} \\  \frac{1}{\sqrt{2}} \end{matrix}  \right) \]



\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\item Находим собственные векторы \[ (A^TA - \lambda_i E) v_i= 0.\]




Собственное значение $\lambda_2 = 9$:

\[ A^TA - 9E =  \left(\begin{matrix} 8 & 8 \\ 8 & 8\end{matrix} \right). \]



Решение единичной длины: \[ \displaystyle \left( \begin{matrix} - \frac{1}{\sqrt{2}} \\  \frac{1}{\sqrt{2}} \end{matrix}  \right) \]



\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}


\item Итак, на данный момент \[  \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right) = U \left( \begin{matrix} 5 & 0 \\ 0 & 3 \\ 0 & 0 \end{matrix} \right)  \left(\begin{matrix} \frac{1}{\sqrt{2}} &- \frac{1}{\sqrt{2}}  \\  \frac{1}{\sqrt{2}}  & \frac{1}{\sqrt{2}} \end{matrix} \right).\]

\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ u_i = \frac{1}{\sigma_i} A v_i.\]


Для $\sigma_1 = 5$: \[ u_1 = \frac{1}{5} \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right) \left(\begin{matrix} \frac{1}{\sqrt{2}}  \\  \frac{1}{\sqrt{2}}  \end{matrix} \right) = \frac{1}{5 \sqrt{2} } \left( \begin{matrix} 5  \\ 5 \\ 0 \end{matrix} \right) =  \left( \begin{matrix}  \frac{1}{ \sqrt{2} }  \\  \frac{1}{ \sqrt{2} } \\ 0 \end{matrix} \right).  \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\vspace{5mm}

\item Находим столбцы $U$ через соотношение \[ u_i = \frac{1}{\sigma_i} A v_i.\]


Для $\sigma_1 = 3$: \[ u_2 = \frac{1}{3} \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right) \left(\begin{matrix} -\frac{1}{\sqrt{2}}  \\  \frac{1}{\sqrt{2}}  \end{matrix} \right) = \frac{1}{3 \sqrt{2} } \left( \begin{matrix} -1  \\ 1 \\ -4 \end{matrix} \right) =  \left( \begin{matrix}  -\frac{1}{3 \sqrt{2} }  \\  \frac{1}{3 \sqrt{2} } \\-\frac{2 \sqrt{2}}{3 } \end{matrix} \right).  \]


\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{enumerate}

\vspace{5mm}

\item Итак, матрица $U$ имеет вид \[\left(
\begin{matrix}
 \frac{1}{\sqrt{2}} & -\frac{1}{3 \sqrt{2}} &* \\
 \frac{1}{\sqrt{2}} & \frac{1}{3 \sqrt{2}} & * \\
 0 & -\frac{2 \sqrt{2}}{3} & *
\end{matrix}
\right)\] Оставшиеся столбцы берём так, чтобы $U$ была ортогональной: \[\left(
\begin{matrix}
 \frac{1}{\sqrt{2}} & -\frac{1}{3 \sqrt{2}} & -\frac{2}{3} \\
 \frac{1}{\sqrt{2}} & \frac{1}{3 \sqrt{2}} & \frac{2}{3} \\
 0 & -\frac{2 \sqrt{2}}{3} & \frac{1}{3}
\end{matrix}
\right)\]
\end{enumerate}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Получаем ответ:
\[  \left( \begin{matrix} 3 & 2  \\ 2 & 3 \\ 2 & -2 \end{matrix} \right) = 
\left(\begin{matrix}
 \frac{1}{\sqrt{2}} & -\frac{1}{3 \sqrt{2}} & -\frac{2}{3} \\
 \frac{1}{\sqrt{2}} & \frac{1}{3 \sqrt{2}} & \frac{2}{3} \\
 0 & -\frac{2 \sqrt{2}}{3} & \frac{1}{3}
\end{matrix}  \right) \left( \begin{matrix} 5 & 0 \\ 0 & 3 \\ 0 & 0 \end{matrix} \right)  \left(\begin{matrix} \frac{1}{\sqrt{2}} &- \frac{1}{\sqrt{2}}  \\  \frac{1}{\sqrt{2}}  & \frac{1}{\sqrt{2}} \end{matrix} \right).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

\begin{alertblock}{Замечания}

\begin{enumerate}

\item Этот алгоритм удобнее применять, если $m \geq n$.  Если $m < n$, то удобнее найти SVD для $A^*$ и потом ещё раз сопрячь. 

\vspace{5mm}

Дело в том, что если $A$ --- $m\times n$ матрица, то матрица $A^*A$ имеет размер $n \times n$, а $A A^*$ --- размер $m \times m$. 

\vspace{5mm}

\item Сингулярные значения обычно берут упорядоченными: \[ \sigma_1 \geq \dots \geq \sigma_r \geq 0.\]


\item Решения \[ (A^* A - \lambda_i E)v_i = 0\] нужно нормировать (т.е. брать векторы единичной длины). Если решение неоднозначно, то нужно брать ортогональные решения.

\vspace{5mm}

\item Если $\sigma_i =0$, то векторы $u_i$ нужно брать единичной длины и ортогональные остальным $u_j$. 



\end{enumerate}

\end{alertblock}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Обоснование алгоритма: 

\[ A^* A = V \Sigma^* U^* U \Sigma V^* = V \Sigma^*  \Sigma V^*.\] Таким образом \[A^* A =  V \left( \begin{matrix}\sigma_{1}^2&& &\\&\sigma_{2}^2& & \\ & & \ddots & \\ & & &\sigma_{n}^2 \end{matrix}  \right) V^* \] 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------





%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Покажем, что \[ A^* A v_i = \sigma^2_i v_i.\]

Поскольку $V$ --- унитарная, то  $V^*V = E$. С другой стороны, \[ V^* V = \left( V^* v_1, \dots, V^* v_n \right).\] Поэтому $V^* v_i = e_i$. Таким образом \[ A^* A v_i = V \left( \begin{matrix}\sigma_{1}^2&& &\\&\sigma_{2}^2& & \\ & & \ddots & \\ & & &\sigma_{n}^2 \end{matrix}  \right) V^* v_i =  V \left( \begin{matrix}\sigma_{1}^2&& &\\&\sigma_{2}^2& & \\ & & \ddots & \\ & & &\sigma_{n}^2 \end{matrix}  \right) e_i =  V \sigma_i^2 e_i = \sigma_i^2 v_i.  \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Из того, что \[ A^* A v_i = \sigma^2_i v_i\] следует, что: 

\vspace{5mm}

\begin{enumerate}

\item собственные значения $A^* A$ --- это $\sigma_i^2$,

\vspace{5mm}

\item соответствующие собственные векторы --- это столбцы $v_i$ матрицы $V$. 

\end{enumerate}

\vspace{5mm}

Поскольку $V$ --- унитарна, векторы $v_i$ попарно ортогональны и имеют единичную длины.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Скелетное разложение через SVD:

\[\displaystyle A=U\Sigma V^{*}={\begin{bmatrix}U_{1}&U_{2}\end{bmatrix}}{\begin{bmatrix}\Sigma _{r}&0\\0&0\end{bmatrix}}{\begin{bmatrix}V_{1}^{*}\\V_{2}^{*}\end{bmatrix}}=U_{1}\left(\Sigma _{r}V_{1}^{*}\right).\]
Иными словами, \[ F = U_{1}, \qquad G = \Sigma _{r}V_{1}^{*}.\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 2}
%----------------------------------------------------------

Псевдообратная через SVD \[ M = U \Sigma V^*.\] 

Тогда {\color{blue} псевдообратная матрица:} \[ M^{+} = V  \Sigma^{+} U^*,\] где \[  \Sigma^{+} =  \left(\frac{1}{\sigma_1}, \dots, \frac{1}{\sigma_k}, 0, \dots, 0\right).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\end{document}
