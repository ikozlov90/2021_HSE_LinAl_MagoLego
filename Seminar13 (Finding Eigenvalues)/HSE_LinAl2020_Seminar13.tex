\documentclass[9pt]{beamer}




\usepackage{beamerthemesplit}
\usetheme{Boadilla}
\usecolortheme{orchid}





 % \usepackage[cp866]{inputenc}                %%% Є®¤Ёа®ўЄ  DOS
  \usepackage[cp1251]{inputenc}
%  \usepackage[T2A]{fontenc}                %%% ???
%\usepackage[english,russian]{babel}
%\usepackage[russian]{babel}
 \usepackage[OT1]{fontenc}
%\usepackage[english]{babel}
\usepackage[russian]{babel}

\usepackage{amssymb,latexsym, amsmath, mathdots}

\usepackage{amscd}
\usepackage{multirow}
\usepackage{comment}

\usepackage{epstopdf}



%\usepackage[table]{xcolor} %colored cells

%\usepackage{tikz}
%\usetikzlibrary{tikzmark} %arrows in tables


\usepackage{mnsymbol} % udots in matrices


 \usepackage{pgfpages}
%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=bottom}
%% \setbeameroption{show notes on second screen}

%\setbeamercolor{alerted text}{fg=red!80!black}


% \setbeamercolor{alerted text}{fg=blue!50!green}
% \setbeamercolor{fortheorem}{bg=blue!15!white}
% \setbeamercolor{EMPF}{bg=blue!25!white}
% \setbeamercolor{EMPF2}{bg=blue!35!white}

%\setbeamersize{text margin left=5.mm, text margin right=5.mm}


%---------------------------------------------------------------------------------------------------------------------------

%\def\emphbox#1#2#3{\begin{beamercolorbox}[wd=#2, ht=#1, center, colsep=1.mm]{EMPF} #3 \end{beamercolorbox}}

%---------------------------------------------------------------------------------------------------------------------------


%\advance\leftskip-5.mm



%***************************************************************************************************************************

\theoremstyle{theorem}
\newtheorem{mytheorem}[theorem]{Теорема}
\newtheorem{mylemma}[theorem]{Лемма}
\newtheorem{mycorollary}[theorem]{Следствие}

\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{assertion}[theorem]{Утверждение}
\newtheorem{remark}[theorem]{Замечание}
\newtheorem{assumption}[theorem]{Предположение}

\newtheorem{convention}[theorem]{Договорённость}
\newtheorem{question}[theorem]{Вопрос}
%\newtheorem{mydefinition}{mydefinition}

\theoremstyle{definition}
\newtheorem{mydefinition}[theorem]{Определение}
\newtheorem{myexample}[theorem]{Пример}



%***************************************************************************************************************************

\chardef\No=194
\newcommand{\bd}{{\rm bd}}
\newcommand{\cl}{{\rm cl}}
\newcommand{\ind}{{\rm ind}}
\newcommand{\id}{{\rm id}}
\newcommand{\inj}{{\sl in}}
\newcommand{\pr}{{\rm pr}}
\newcommand{\st}{{\rm St}}


\DeclareMathOperator{\sgrad}{sgrad}

\DeclareMathOperator{\cnt}{const}

\DeclareMathOperator{\Aut}{Aut}


\DeclareMathOperator{\sgn}{sgn}

\DeclareMathOperator{\Int}{Int}


\DeclareMathOperator{\tr}{tr}

\DeclareMathOperator{\Mat}{Mat}







%****************************************************************************
\newcommand{\Ker}{\mathrm{Ker}\,\,}
\newcommand{\Ann}{\mathrm{Ann}\,\,}

\newcommand{\Imm}{\mathrm{Im}\,\,}

\newcommand{\rk}{\mathrm{rk}\,\,}

\newcommand{\const}{\mathrm{const}}



\DeclareMathOperator{\Pen}{\mathcal{P}}


\DeclareMathOperator{\Core}{K}


\DeclareMathOperator{\BLG}{\operatorname{BLG}}

\DeclareMathOperator{\AutBP}{\operatorname{Aut}(V, \mathcal{P})}


\def\minus{\hbox{-}}   %Sign of minus in big matrices

\usepackage{multirow}  %Columns spanning multiple rows

\usepackage[normalem]{ulem} %underline that can break lines

%****************************************************************************



\title% [] (optional, only for long titles)
{МАГОЛЕГО\\ Линейная алгебра в приложениях \\ Семинар 13}
%\subtitle{}
\author [Д.\,И.~Пионтковский, И. \,К.~Козлов] %(optional, for multiple authors)
{Д.\,И.~Пионтковский, И. \,К.~Козлов \\ {\footnotesize(\textit{ВШЭ})}}


\date % [](optional)
{23 апреля 2021}
%\subject{Mathematics}








\usepackage{hyperref}
\hypersetup{unicode=true}



\begin{document}

%\includeonlyframes{}
\frame{\titlepage}




\section{Вычисление характеристического многочлена}

\begin{frame}[plain]\frametitle{Вычисление характеристического многочлена} \tableofcontents[currentsection]\end{frame}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


\begin{itemize}

\item \textbf{Характеристический многочлен} оператора $A$: \[ \chi_A(\lambda)= \det (A - \lambda E).\]


\item \textbf{Минимальный многочлен}  $m_A$ = многочлен наименьшей степени т.,ч. \[ m_A(A) = 0.\]


\end{itemize}

\begin{block}{Теорема Гамильтона-Кэли} $\chi_A(A) = 0$. \end{block}

\vspace{5mm}

Как (эффективно) вычислять минимальный и характеристический многочлены?

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Для одного жорданова $n \times n$ блока \[ J = {\displaystyle {\left( \begin{matrix}\lambda_0 &1&0&\cdots &0\\0&\lambda_0 &1&\cdots &0\\\vdots &\vdots &\vdots &\ddots &\vdots \\0&0&0&\lambda_0 &1\\0&0&0&0&\lambda_0 \end{matrix} \right) } } \] минимальный многочлен совпадает с характеристическим: \[ m_J (\lambda)= \chi_J(\lambda) = \left(\lambda - \lambda_0 \right)^n.\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


В общем нужно рассмотреть ЖНФ (жорданову нормальну форму) $A$: 

\vspace{5mm}


\begin{itemize}

\item Характеристический многочлен $A$ --- \textbf{произведение} характеристических многочленов своих жордановых блоков.

\vspace{5mm}

\item Минимальный многочлен $A$ --- \textbf{НОК} минимальных многочленов своих жордановых блоков.

\end{itemize}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\subsection{Метод Крылова (вычисление минимального многочлена)}

\begin{frame}[plain]\frametitle{Метод Крылова (вычисление минимального многочлена)} \tableofcontents[currentsubsection]\end{frame}

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


{\color{blue} Метод Крылова} нахождения минимального многочлена. 

\vspace{5mm} 


\begin{enumerate}

\item Берём вектор $v_1 \not =0$ и далее векторы \[ v_1, \quad  Av_1, \quad \dots,  \quad A^{k_1} v_1\] пока они не станут линейно зависимыми.

\vspace{5mm}

\item Пусть линейная зависимость \[c_{k_1} A^{k_1}v_1 + \dots c_0 v_1 =0.\] Берём многочлен с этими коэффициентами: \[ f_1(x) = c_{k_1} x^{k_1} + \dots c_0. \]


\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

{\color{blue} Метод Крылова} (продолжение).


\begin{enumerate}



\item Если векторы  $A^k v_1$ не порождают всё пространство, то берём линейно независимый с ними вектор $v_2$. Аналогично строим многочлен $f_2(x)$ для $v_2, \dots A^{k_2} v_2$. 

\vspace{5mm} 

\item И т.д.  --- берём векторы $v_i$, линейно независимые с построенными векторами $A^k v_j$ и аналогично строить многочлены $f_i(x)$.

\vspace{5mm}

Продолжаем процесс, пока $A^k v_j$ не породят всё пространство (т.е. пока не взяли $n = \dim V$ линейно независимых векторов). 



\vspace{5mm} 

\item Искомый минимальный многочлен будет \[  m(x) = \text{НОК} \left(f_1, f_2 \dots,  \right)\]

\end{enumerate}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

\textbf{Задача}. Методом Крылова найти минимальный многочлен \[ A = \left( \begin{matrix} -1 & 0 & 1 & 2 \\ 7 & 1 & 0 & 1 \\ -1 & 1 & 8 & 11 \\ 0 & 0 & 1 & 0  \end{matrix} \right). \] 




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

\textbf{Решение}. Берём вектор \[ v_1 = \left( \begin{matrix} 1 \\ 0 \\ 0 \\ 0 \end{matrix} \right). \] Берём векторы \[ v_1, Av_1, A^2 v_1, \dots \] пока они не станут линейно зависимыми. В данном случае \[ v_1 = \left( \begin{matrix} 1 \\ 0 \\ 0 \\ 0 \end{matrix} \right), \qquad Av_1 =\left( \begin{matrix}  -1 \\ 7 \\ -1 \\ 0  \end{matrix} \right), \qquad   A^2v_1 =\left( \begin{matrix}  0 \\ 0 \\ 0 \\ 1  \end{matrix} \right), \qquad A^3 v_1 =\left( \begin{matrix}  -2 \\ -1 \\ -11 \\ 0  \end{matrix} \right). \] Наконец \[A^4 v_1 =\left( \begin{matrix}  -9 \\ -15 \\ -87 \\ -11  \end{matrix} \right) = 6v_1 - Av_1 + 11 A^2 v_1 + 8A^3v_1.  \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Мы получили соотношение 

\[A^4 v_1 - 8A^3v_1  - 11 A^2 v_1   + Av_1  - 6v_1 =0.  \]

Значит, минимальный многочлен $m(x)$ делится на \[ f_1(x) = x^4 - 8 x^3  - 11 x^2  + x  -6. \]

Векторы $A^k v_1$ порождают всё пространство, значит \textbf{Ответ:} \[m(x) x^4 - 8 x^3  - 11 x^2  + x  -6. \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




\subsection{Метод Данилевского (вычисление характеристического многочлена)}

\begin{frame}[plain]\frametitle{Метод Данилевского (вычисление характеристического многочлена)} \tableofcontents[currentsubsection]\end{frame}




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------




\textbf{Идея метода Данилевского}.  Приведём сопряжением $A \to B^{-1} AB$ матрицу $A$ к фробениусовой форме \[A={\begin{pmatrix} p_{1} & p_{2} & \dots & p_{n-1} & p_n\\ 1&0 & \dots & 0 & 0\\0&1 & \dots & 0 &0\\\vdots &\vdots &\ddots &\vdots &\vdots \\0&0 &\cdots  & 1& 0\end{pmatrix}}.\] Характеристический многочлен этой матрицы: \[ \chi(\lambda) = (-1)^n \left( \lambda^n - p_1 \lambda^{n-1} - \dots - p_n\right).\] 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

{\color{blue} Метод Данилевского}. Мы будем последовательно сопрягать матрицу $A = A_0$: \[ A_1 = B_1^{-1} A_0 B_1, \qquad \cdots \qquad  A_j = B_j^{-1} A_{j-1} B_j\] 

\vspace{5mm}

После $k$ шагов $k$ нижних строк у $A_k$ будут как в форме Фробениуса.  Например, \[A_2={\begin{pmatrix} * &  \dots &  *  & * & *  & * \\ * &\dots & *  & * & * & *\\ *  & \dots  &  *  & * & * & * \\ 0 &\cdots & 0  &1 &0 & 0\\0&\cdots & 0 & 0  & 1& 0\end{pmatrix}}.\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


Как находится $B_k$?

\vspace{5mm}

Пример. для матриц $4\times 4$:  \[ B_1^{-1} = \begin{pmatrix}1 & 0 & 0 &0\\ 0&1 & 0 & 0
%
\\  a_{41} & a_{42} & a_{43} & a_{44} \\  
%
0 & 0 & 0 & 1 \\
\end{pmatrix}. \] При этом \[ B_1 = \begin{pmatrix}1 & 0 & 0 &0\\ 0&1 & 0 & 0
%
\\[6pt] \displaystyle -\frac{a_{41}}{a_{43}} & \displaystyle -\frac{a_{42}}{a_{43}}  & \displaystyle \frac{1}{a_{43}} & \displaystyle -\frac{a_{44}}{a_{43}} \\[6pt]
%
0 & 0 & 0 & 1 \\
\end{pmatrix} \] 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



На $k$-том шаге. \textbf{Левая матрицу $B^{-1}_{k}$}:


\vspace{5mm}


\begin{itemize} 

\item $k+1$ строка снизу суть $k$-тая строка $A_k$ снизу (подняли строчку на 1 вверх).

\vspace{5mm}

\item остальные строчки --- как у единичной матрицы.


\end{itemize} 

\vspace{5mm}

 \textbf{Правая матрицу $B_{k}$} по $B^{-1}_k$:
 
 \vspace{5mm}

\begin{itemize} 

\item $k+1$ строка снизу. Диагональный элемент $b$ в $B^{-1}_k$ обращается, остальные --- умножаются на $- \frac{1}{b}$.

\vspace{5mm}

\item Остальные строчки --- как у единичной матрицы.


\end{itemize} 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


\textbf{Задача}. Методом Данилевского найти характеристический многочлен \[ A = \left( \begin{matrix} 3 & 1 & 2 & 4 \\ 7 & 1 & 0 & 1 \\ 2 & 1 & 2 & 3 \\ 4 & 1 & 2 & 2  \end{matrix} \right). \]  

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------







%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

\textbf{Решение}.

\vspace{5mm}

\begin{enumerate}

\item Заменим матрицу $A$ на $B_{1}^{-1} A B_1$, где \[ B_1^{-1} = \begin{pmatrix}1 & 0 & 0 &0\\ 0&1 & 0 & 0
%
\\  a_{41} & a_{42} & a_{43} & a_{44} \\  
%
0 & 0 & 0 & 1 \\
\end{pmatrix}. \] При этом \[ B_1 = \begin{pmatrix}1 & 0 & 0 &0\\ 0&1 & 0 & 0
%
\\[6pt] \displaystyle -\frac{a_{41}}{a_{43}} & \displaystyle -\frac{a_{42}}{a_{43}}  & \displaystyle \frac{1}{a_{43}} & \displaystyle -\frac{a_{44}}{a_{43}} \\[6pt]
%
0 & 0 & 0 & 1 \\
\end{pmatrix} \] 

\end{enumerate}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


 Получаем новую матрицу: \begin{gather*} A_2 = B_1^{-1} A B_1 =  \\ = \left(
\begin{array}{cccc}
 1 & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 \\
 4 & 1 & 2 & 2 \\
 0 & 0 & 0 & 1
\end{array}
\right) \left(
\begin{array}{cccc}
 3 & 1 & 2 & 4 \\
 7 & 1 & 0 & 1 \\
 2 & 1 & 2 & 3 \\
 4 & 1 & 2 & 2
\end{array}
\right) \left(
\begin{array}{cccc}
 1 & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 \\
 -2 & -\frac{1}{2} & \frac{1}{2} & -1 \\
 0 & 0 & 0 & 1
\end{array}
\right) = \\ = \left(
\begin{array}{cccc}
 -1 & 0 & 1 & 2 \\
 7 & 1 & 0 & 1 \\
 -1 & 1 & 8 & 11 \\
 0 & 0 & 1 & 0
\end{array}
\right).\end{gather*}

Мы привели последнюю строчку к нужному виду. 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



\vspace{5mm}

\begin{enumerate}

\setcounter{enumi}{2}

\item Заменим матрицу $A_2$ на $B_{2}^{-1} A_2 B_2$, где \[ B_2^{-1} = \begin{pmatrix}1 & 0 & 0 &0\\ a_{31} & a_{32} & a_{33} & a_{34}  \\  0&0 &1 & 0  \\  
%
0 & 0 & 0 & 1 \\
\end{pmatrix}. \] При этом \[ B_2 = \begin{pmatrix}1 & 0 & 0 &0\\[6pt] \displaystyle -\frac{a_{31}}{a_{32}} & \displaystyle \frac{1}{a_{32}}  & \displaystyle -\frac{a_{33}}{a_{32}} & \displaystyle -\frac{a_{34}}{a_{32}} \\[6pt]  0&0& 1 & 0\\
%
0 & 0 & 0 & 1 \\
\end{pmatrix} \] 

\end{enumerate} Здесь $a_{ij}$  --- элементы матрицы $A_2$.



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



 Получаем новую матрицу: \begin{gather*} A_3 = B_2^{-1} A_2 B_2 =  \\ =\left(
\begin{array}{cccc}
 1 & 0 & 0 & 0 \\
 -1 & 1 & 8 & 11 \\
 0 & 0 & 1 & 0 \\
 0 & 0 & 0 & 1
\end{array}
\right)
%
 \left(
\begin{array}{cccc}
 -1 & 0 & 1 & 2 \\
 7 & 1 & 0 & 1 \\
 -1 & 1 & 8 & 11 \\
 0 & 0 & 1 & 0
\end{array}
\right)
%
 \left(
\begin{array}{cccc}
 1 & 0 & 0 & 0 \\
 1 & 1 & -8 & -11 \\
 0 & 0 & 1 & 0 \\
 0 & 0 & 0 & 1
\end{array}
\right)= \\ =\left(
\begin{array}{cccc}
 -1 & 0 & 1 & 2 \\
 9 & 9 & 2 & -12 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0
\end{array}
\right).\end{gather*}

Мы привели две последние строчки к нужному виду. 






%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



\vspace{5mm}

\begin{enumerate}

\setcounter{enumi}{2}

\item Заменим матрицу $A_3$ на $B_{3}^{-1} A_3 B_3$, где \[ B_3^{-1} = \begin{pmatrix} a_{21} & a_{22} & a_{23} & a_{24}  \\ 0 & 1 & 0 &0\\ 0&0 &1 & 0  \\  0 & 0 & 0 & 1 \\
\end{pmatrix}. \] При этом \[ B_3 = \begin{pmatrix} \displaystyle \frac{1}{a_{21}} & \displaystyle -\frac{a_{22}}{a_{21}}  & \displaystyle -\frac{a_{23}}{a_{21}} & \displaystyle -\frac{a_{24}}{a_{21}} \\[6pt]  0 & 1 & 0 &0\\ 0&0& 1 & 0\\
%
0 & 0 & 0 & 1 \\
\end{pmatrix} \] 

\end{enumerate} Здесь $a_{ij}$  --- элементы матрицы $A_3$.



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



 Получаем новую матрицу: \begin{gather*} A_4 = B_3^{-1} A_3 B_3 =  \\ =
\left(
\begin{array}{cccc}
 9 & 9 & 2 & -12 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0 \\
 0 & 0 & 0 & 1
\end{array}
\right)
%
\left(
\begin{array}{cccc}
 -1 & 0 & 1 & 2 \\
 9 & 9 & 2 & -12 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0
\end{array}
\right)
%
\left(
\begin{array}{cccc}
 \frac{1}{9} & -1 & -\frac{2}{9} & \frac{4}{3} \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0 \\
 0 & 0 & 0 & 1
\end{array}
\right)= \\ =\left(
\begin{array}{cccc}
 8 & 11 & -1 & 6 \\
 1 & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0
\end{array}
\right).\end{gather*}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------





%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Искомая матрица $A$ подобна \[ B^{-1} AB = \left(
\begin{array}{cccc}
 8 & 11 & -1 & 6 \\
 1 & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 1 & 0
\end{array}
\right).\]

\vspace{5mm}

\textbf{Ответ}. Характеристический многочлен $A$: \[ \det (A - \lambda E) = \lambda^4 - 8 \lambda^3 - 11 \lambda^2 + \lambda - 6.\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\subsection{Метод Фадеева-Леверрье}

\begin{frame}[plain]\frametitle{Метод Фадеева-Леверрье} \tableofcontents[currentsubsection]\end{frame}




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

{\color{cyan} Метод Фадеева-Леверрье:}

\vspace{5mm}

Строим семейство матриц $B_i$ и полиномы $p_i$ по формулам:


\[
\begin{aligned}
B_1 = A & \qquad & p_1 = \operatorname{tr}B_1 \\
B_2 = A (B_1 - p_1 I) & \qquad & p_2 = \frac{1}{2}\operatorname{tr}B_2 \\
\dots & \qquad & \dots \\
B_{k} = A (B_{k-1} - p_{k-1} I) & \qquad & p_k = \frac{1}{k}\operatorname{tr}B_k \\
\dots & \qquad & \dots \\
B_n = A (B_{n-1} - p_{n-1} I) & \qquad & p_n = \frac{1}{n}\operatorname{tr}B_n 
\end{aligned}
\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


\begin{itemize}

\item Характеристический многочлен находится по формуле:

\[p(\lambda) = \lambda^n - p_1 \lambda^{n-1} - p_2 \lambda^{n-2}  - \dots -  p_n. \]

\vspace{5mm}

\item Обратная матрица находится по формуле:

\[A^{-1} = \frac{1}{p_n} (B_{n-1} - p_{n-1} I). \]

\end{itemize}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

\textbf{Упражнение}. Методом Фадеева-Леверрье найти характеристический многочлен и обратную матрицу для матрицы \[\left( \begin{matrix} 2 & -1 & 2 \\ -1 & 2 & 1 \\ 1 & -1 & 2 \end{matrix} \right) \]

\textbf{Решение}. См. Jupyter Notebook.

 
%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\section{Нахождение собственных значений}

\begin{frame}[plain]\frametitle{Семинар 13} \tableofcontents[currentsection]\end{frame}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Литература}
%----------------------------------------------------------


\begin{thebibliography}{10}
  \beamertemplatebookbibitems
  \bibitem{Gantmacher} Шевцов Г.С.,
    \newblock {\em  Линейная алгебра: теория и прикладные аспекты},
     \newblock {Глава 11. О приближённых методах вычисления собственных значений и собственных векторов},
  \end{thebibliography}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


Три основных способа вычисления собственных значений: 

\vspace{2mm}


\begin{enumerate}

\item \textit{Через $QR$ разложение.} Для любых матриц (но не всегда сходится). Итеративно полагаем \[A_k = Q_k R_k, \qquad A_{k+1} = R_k Q_k.\]

\vspace{2mm}


\item \textit{Степенной метод.} При $A = A^T$. Векторы \[ v_k = A^k v\] стремятся к собственному вектору с наибольшим собственным значением $\lambda$. Далее ``убиваем это собственное значение'' \[ A  \to A - \lambda \frac{v \cdot v^T}{(v, v)}\] и повторяем процесс.


\vspace{2mm}


\item \textit{Метод Якоби.} При $A = A^T$. Вращениями в двумерных плоскостях зануляем коэффициенты, поэтому матрица не станет близкой к диагональной.

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




\subsection{Метод вращения (метод Якоби)}

\begin{frame}[plain]\frametitle{Метод вращения (метод Якоби)} \tableofcontents[currentsubsection]\end{frame}







%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


Метод вращений:


\vspace{5mm}


\begin{thebibliography}{10}
  \beamertemplatebookbibitems
  \bibitem{Gantmacher} Шевцов Г.С.,
    \newblock {\em  Линейная алгебра: теория и прикладные аспекты},
        \newblock{ Глава 11.1 Метод вращений (метод Якоби)}
  \end{thebibliography}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

\vspace{5mm}

Как привести симметричную матрицу $\displaystyle  A = A^T$ к диагональному виду. 


\vspace{5mm}

Приведение к главным осям: существует ортогональная $Q$ т.,ч. \[ Q^T A Q = \left(\begin{matrix}\lambda_1 &0&0\\0&\ddots&0\\0&0&\lambda_n \end{matrix} \right).\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


Начнём с двумерного случая  $\displaystyle  A = \left( \begin{matrix} a & b \\ b & c\end{matrix} \right)$. 

\vspace{5mm}

В качестве $Q$ в $Q^T AQ$ можно взять поворот:

\[ \left( \begin{matrix} \cos{\varphi} & -\sin{\varphi} \\ \sin{\varphi} & \cos{\varphi}\end{matrix} \right)^T \left( \begin{matrix} a & b \\ b & c\end{matrix} \right)\left( \begin{matrix} \cos{\varphi} & -\sin{\varphi} \\ \sin{\varphi} & \cos{\varphi}\end{matrix} \right) = \left( \begin{matrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{matrix} \right) \] 


\vspace{5mm}

Достаточно сделать первый собственный вектор базисным: \[ A' e_1' = \lambda_1 e_1'.\] Тогда первый столбец справа  будет $ \left( \begin{matrix} \lambda_1 \\  0 \end{matrix} \right)$.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



{\color{blue} Метод вращения.}

\vspace{5mm}

Находим в матрице $A$ наибольший по модулю недиагональный элемент $a_{ij}$.  Берём матрицу 
\[{\displaystyle R(i,j,\theta )={\left(\begin{array}{ccccccccccc}   1 &  & &  &   &  & & & & &  \\
%
&\ddots & & & & & & & & &\\
%
& & 1 & & & & & & & & \\
%
& & & \cos{\varphi} & &  & &- \sin \varphi & & & \\
 %
& & & & 1 & & & &  \\
 %
& & & & &\ddots & & &  \\
 %
& & & & & & 1 & & & & \\
 %
 & & & \sin \varphi && & & \cos \varphi & & & \\
 %
  &  & & & & & & & 1   & &  \\
 %
 & & & & & & & & & \ddots & \\
 %
 &  & & & & & & & & & 1  \end{array}\right) }}.\] 

Это поворот на угол $\varphi$ в плоскости векторов $e_i, e_j$. Здесь  \[ r_{ij} =r_{jj} = \cos{\varphi}, \qquad r_{ij} = - \sin \varphi, \qquad r_{ji} = \sin \varphi.\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Чему равен $\varphi$? Если  $a_{ii} = a_{jj}$, то $\displaystyle \varphi = \frac{\pi}{4}$: \[{\displaystyle R(i,j,\theta )={\left(\begin{array}{ccccccccccc}   1 &  & &  &   &  & & & & &  \\
%
&\ddots & & & & & & & & &\\
%
& & 1 & & & & & & & & \\
%
& & & \frac{1}{\sqrt{2}} & &  & &- \frac{1}{\sqrt{2}} & & & \\
 %
& & & & 1 & & & &  \\
 %
& & & & &\ddots & & &  \\
 %
& & & & & & 1 & & & & \\
 %
 & & &\frac{1}{\sqrt{2}} && & &\frac{1}{\sqrt{2}} & & & \\
 %
  &  & & & & & & & 1   & &  \\
 %
 & & & & & & & & & \ddots & \\
 %
 &  & & & & & & & & & 1  \end{array}\right) }}.\]   

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


В остальных случаях $\varphi$ находится из \[ \tan 2 \varphi = \frac{2 a_{ij}}{a_{ii} - a_{jj}}, \qquad \left| \varphi \right| \leq \frac{\pi}{4}. \] Косинус и синус находятся из: \begin{gather*}  \cos 2 \varphi =  \frac{1}{\sqrt{1 + \tan^2 2 \varphi}} \\ \cos  \varphi =  \sqrt{ \frac{1+\cos2\varphi}{2}}, \qquad \sin  \varphi =  \pm \sqrt{ \frac{1-\cos2\varphi}{2}} \end{gather*} Знак синуса равен знаку \[ a_{ij} (a_{ii} - a_{jj}).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Итеративный процесс: на каждом шаге находим $R =  R(i,j,\theta )$ и меняем  \[ A_{k+1} = R^T A_k R\]

\vspace{5mm}

Применяем процесс, пока $A_k$ не станет почти диагональной.  Тогда элементы на диагонали аппроксимируют собственные значения матрицы $A$.

\vspace{5mm}

Обычно процесс быстро сходится.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------




\textbf{Задача}. Найти собственные векторы и собственные значения методом вращения.
\[ \left( \begin{matrix}2 & 2 & -2 \\ 2 & 5 & -4 \\ -2 & -4 & 5 \end{matrix} \right). \] 

\vspace{5mm}

\textbf{Решение}. Наибольший по модулю недиагональный элемент \[ a_{23} = -4.\] Тогда \[ a_{22} = a_{33} = 5.\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Здесь $a_{ii} = a_{jj}$, поэтому $\displaystyle \varphi = \frac{\pi}{4}$.


\[{\displaystyle R = R(i,j,\theta )={\left(\begin{array}{ccccccccccc}   1 & 0  & 0 \\[6pt] \displaystyle
%
 0 & \frac{1}{\sqrt{2}} &- \frac{1}{\sqrt{2}} \\[6pt] \displaystyle
 %
 0 &\frac{1}{\sqrt{2}}  &\frac{1}{\sqrt{2}} \\
  \end{array}\right) }}.\]   
  
  
%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Первая итерация: \begin{gather*} A_1 = R^T A R = \\ = \left(\begin{array}{ccccccccccc}   1 & 0  & 0 \\[6pt] \displaystyle
%
 0 & \frac{1}{\sqrt{2}} &\frac{1}{\sqrt{2}} \\[6pt] \displaystyle
 %
 0 &-\frac{1}{\sqrt{2}}  &\frac{1}{\sqrt{2}} \\
  \end{array}\right) 
  %
   \left( \begin{matrix}2 & 2 & -2 \\ 2 & 5 & -4 \\ -2 & -4 & 5 \end{matrix} \right)
  %
  \left(\begin{array}{ccccccccccc}   1 & 0  & 0 \\[6pt] \displaystyle
%
 0 & \frac{1}{\sqrt{2}} &- \frac{1}{\sqrt{2}} \\[6pt] \displaystyle
 %
 0 &\frac{1}{\sqrt{2}}  &\frac{1}{\sqrt{2}} \\
  \end{array}\right) = \\ =  \left( \begin{matrix} 2 & 0 & -2 \sqrt{2} \\ 0 & 1 & 0 \\ -2 \sqrt{2} & 0 & 9 \end{matrix} \right). \end{gather*}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

   Наибольший по модулю недиагональный элемент \[ a_{13} = -2 \sqrt{2}.\] Тогда \[ a_{11} = 2, \qquad a_{33} = 9.\]
  
%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Находим угол поворота:  \[ \tan 2 \varphi = \frac{2 a_{ij}}{a_{ii} - a_{jj}} = \frac{-4\sqrt{2}}{2 - 9} = \frac{4\sqrt{2}}{7}. \] Поэтому: \[\cos 2 \varphi =  \frac{1}{\sqrt{1 + \tan^2 2 \varphi}} =   \frac{7}{9}.    \] Косинус и синус:
\begin{gather*}  \cos  \varphi =  \sqrt{ \frac{1+\cos2\varphi}{2}} = \frac{2\sqrt{2}}{3}, \qquad \sin  \varphi =  \pm \sqrt{ \frac{1-\cos2\varphi}{2}} = \frac{1}{3} \end{gather*} Знак у синуса как у \[ a_{ij} (a_{ii} - a_{jj}) = -2  \sqrt{2} (2-9)>0.\]



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


Итак, \begin{gather*}  \cos  \varphi = \frac{2\sqrt{2}}{3}, \qquad \sin  \varphi =  \frac{1}{3} \end{gather*} Матрица поворота: \[ R =  \left(\begin{array}{ccccccccccc}   \displaystyle   \frac{2\sqrt{2}}{3} & 0  & \displaystyle -   \frac{1}{3} \\[6pt] \displaystyle
%
 0 & 1  & 0 \\[6pt] \displaystyle
 %
  \frac{1}{3}  & 0 & \displaystyle  \frac{2\sqrt{2}}{3}  \\
  \end{array}\right).\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

вторая итерация: \begin{gather*} A_2 = R^T A_1 R = \\ 
%
=  \left(\begin{array}{ccccccccccc}   \displaystyle   \frac{2\sqrt{2}}{3} & 0  & \displaystyle  \frac{1}{3} \\[6pt] \displaystyle
%
 0 & 1  & 0 \\[6pt] \displaystyle
 %
-  \frac{1}{3}  & 0 & \displaystyle  \frac{2\sqrt{2}}{3}  \\
  \end{array}\right)
  %
  \left( \begin{matrix} 2 & 0 & -2 \sqrt{2} \\ 0 & 1 & 0 \\ -2 \sqrt{2} & 0 & 9 \end{matrix} \right)
  %
  \left(\begin{array}{ccccccccccc}   \displaystyle   \frac{2\sqrt{2}}{3} & 0  & \displaystyle -   \frac{1}{3} \\[6pt] \displaystyle
%
 0 & 1  & 0 \\[6pt] \displaystyle
 %
  \frac{1}{3}  & 0 & \displaystyle  \frac{2\sqrt{2}}{3}  \\
  \end{array}\right)= \\ 
  %
  =  \left( \begin{matrix}1 & 0 & 0\\ 0 & 1 & 0 \\ 0  & 0 & 10 \end{matrix} \right). \end{gather*}


Нашли собственные значения \[ \lambda_1 = 1, \qquad \lambda_2 = 1, \qquad \lambda_3 = 10.\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

Как искать собственные векторы?

\vspace{5mm}

Методом вращения --- умножением на матрицы $R_1, \dots R_k$ привели матрицу $A$ к диагональному виду: \[ \Lambda = R_k^T \dots R_1^T A R_1 \dots R_k. \]

Тогда \textbf{собственные векторы --- это столбцы} \[ R_1 \dots R_k.\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------

В данном случае 
\[{\left(\begin{array}{ccccccccccc}   1 & 0  & 0 \\[6pt] \displaystyle
%
 0 &  \displaystyle  \frac{1}{\sqrt{2}} &  \displaystyle  - \frac{1}{\sqrt{2}} \\[6pt] \displaystyle
 %
 0 & \displaystyle  \frac{1}{\sqrt{2}}  &  \displaystyle  \frac{1}{\sqrt{2}} \\
  \end{array}\right) } \left(\begin{array}{ccccccccccc}   \displaystyle   \frac{2\sqrt{2}}{3} & 0  & \displaystyle -   \frac{1}{3} \\[6pt] \displaystyle
%
 0 & 1  & 0 \\[6pt] \displaystyle
 %
  \frac{1}{3}  & 0 & \displaystyle  \frac{2\sqrt{2}}{3}  \\
  \end{array}\right) = \left(
\begin{array}{ccc}
\displaystyle  \frac{2 \sqrt{2}}{3} & 0 & \displaystyle -\frac{1}{3} \\[6pt]
\displaystyle  -\frac{1}{3 \sqrt{2}} & \displaystyle \frac{1}{\sqrt{2}} & \displaystyle -\frac{2}{3} \\[6pt]
\displaystyle \frac{1}{3 \sqrt{2}} & \displaystyle \frac{1}{\sqrt{2}} & \displaystyle \frac{2}{3}
\end{array}
\right).\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


\textbf{Ответ:} У матрицы  \[\left( \begin{matrix}2 & 2 & -2 \\ 2 & 5 & -4 \\ -2 & -4 & 5 \end{matrix} \right)\]
собственные значения:  \[ \lambda_1 = 1, \qquad \lambda_2 = 1, \qquad \lambda_3 = 10,\] и собственные векторы 
 \[ v_1 =\left(
\begin{array}{c}
 \displaystyle \frac{2 \sqrt{2}}{3} \\[6pt]
 \displaystyle -\frac{1}{3 \sqrt{2}}\\[6pt]
 \displaystyle   \frac{1}{3 \sqrt{2}}
\end{array}
\right), \qquad 
v_2 = \left(
\begin{array}{c}
 0 \\[6pt]
 \displaystyle \frac{1}{\sqrt{2}}  \\[6pt]
 \displaystyle \frac{1}{\sqrt{2}}
\end{array}
\right), \qquad v_3 = \left(
\begin{array}{c}
 \displaystyle -\frac{1}{3} \\[6pt]
 \displaystyle -\frac{2}{3} \\[6pt]
 \displaystyle \frac{2}{3}
\end{array}
\right).\]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------



{\color{blue} Метод Якоби.} Для самосопряжённых матриц \[\bar{A}^T = A.\] 

Меняем матрицу на \[ A \to \bar{R}^T A R.\]

Находим в матрице $A$ наибольший по модулю недиагональный элемент $a_{ij}$.  На этот раз матрица
\[{\displaystyle R(i,j,\theta )={\left(\begin{array}{ccccccccccc}   1 &  & &  &   &  & & & & &  \\
%
&\ddots & & & & & & & & &\\
%
& & 1 & & & & & & & & \\
%
& & & \cos{\varphi} & &  & &- e^{i\theta}\sin \varphi & & & \\
 %
& & & & 1 & & & &  \\
 %
& & & & &\ddots & & &  \\
 %
& & & & & & 1 & & & & \\
 %
 & & & e^{-i\theta}\sin \varphi && & & \cos \varphi & & & \\
 %
  &  & & & & & & & 1   & &  \\
 %
 & & & & & & & & & \ddots & \\
 %
 &  & & & & & & & & & 1  \end{array}\right) }}.\] 



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Семинар 13}
%----------------------------------------------------------


\begin{itemize}

\item Для $\varphi$ формулы те же, но $a_{ij}$ меняется на $\left| a_{ij}\right|$: \[ \tan 2 \varphi = \frac{2 \left| a_{ij}\right|}{a_{ii} - a_{jj}}.\]

\vspace{5mm}

\item  Угол $\theta$ берётся как у $a_{ij}$: \[ \theta = \arg a_{ij}.\] Напомним, что \[e^{i \theta} = \cos{\theta} + i \sin{\theta}.\] Заметим, что \[ e^{i\theta} = \frac{a_{ij}}{\left| a_{ij} \right|}.\]

\end{itemize}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\end{document}

